<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="CSS/ludo-stylesheet.css" />
    <link rel="stylesheet" href="CSS/Dice-stylesheet.css" />
    <link rel="stylesheet" href="CSS/Color-Pic-stylesheet.css" />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <title>Ludo</title>
  </head>

  <body>
    <!-- <audio autoplay loop>
      <source src="SINISTRA - Shonci x Hr.caf" type="audio/mpeg">
    </audio> -->
    <div class="container">
      <div class="pop-up-cover">
        <div class="pop-up" id="pop-up">
          <div class="players">
            <button onclick="offlineMode()">Play Offline</button>
            <button>Play Online</button>
          </div>
        </div>
      </div>
      <div class="board-bg">
        <div class="player-game-info">
          <div class="player player-1-info">
            <div class="player-cover player-1-cover"></div>
            <div class="player-info">
              <p></p>
            </div>
            <div class="winning-pins">
              <div class="win-pin win-green-pin pin"></div>
              <div class="win-pin win-green-pin pin"></div>
              <div class="win-pin win-green-pin pin"></div>
              <div class="win-pin win-green-pin pin"></div>
            </div>
          </div>
          <div class="player player-2-info">
            <div class="player-cover player-2-cover"></div>
            <div class="player-info">
              <p></p>
            </div>
            <div class="winning-pins">
              <div class="win-pin win-yellow-pin pin"></div>
              <div class="win-pin win-yellow-pin pin"></div>
              <div class="win-pin win-yellow-pin pin"></div>
              <div class="win-pin win-yellow-pin pin"></div>
            </div>
          </div>
          <div class="alert-player">
            <div class="alert-box" id="alert">
              <p></p>
            </div>
          </div>
        </div>

        <div class="board">
          <div class="board-cover"></div>
          <div class="green green-bg home">
            <div class="flash"></div>
            <div class="pins">
              <div
                class="pin green-bg-lighter green-pin-1 pin-in-parent-1"
              ></div>
              <div
                class="pin green-bg-lighter green-pin-2 pin-in-parent-2"
              ></div>
              <div
                class="pin green-bg-lighter green-pin-3 pin-in-parent-3"
              ></div>
              <div
                class="pin green-bg-lighter green-pin-4 pin-in-parent-4"
              ></div>
            </div>
          </div>
          <div class="boxes">
            <div
              class="box white-box-1-1 step-1"
              data-blue-step="37"
              data-red-step="24"
              data-yellow-step="50"
              data-green-step="11"
            ></div>
            <div
              class="box white-box-1-2 step-2"
              data-blue-step="38"
              data-red-step="25"
              data-yellow-step="51"
              data-green-step="12"
              style="position: relative"
            >
              <i
                class="fa-solid fa-turn-down arrow-icon"
                style="margin-bottom: -100%"
              ></i>
            </div>
            <div
              class="box white-box-1-3 step-3"
              data-blue-step="39"
              data-red-step="26"
              data-green-step="13"
            ></div>
            <div
              class="box white-box-1-4 step-52"
              data-blue-step="36"
              data-red-step="23"
              data-yellow-step="49"
              data-green-step="10"
            ></div>
            <div class="box yellow-bg" data-yellow-step="52"></div>
            <div
              class="box yellow-bg step-4"
              data-blue-step="40"
              data-red-step="27"
              data-yellow-step="1"
              data-green-step="14"
            ></div>
            <div
              class="box white-box-1-5 step-51 grid"
              data-blue-step="35"
              data-red-step="22"
              data-yellow-step="48"
              data-green-step="9"
            ></div>
            <div class="box yellow-bg" data-yellow-step="53"></div>
            <div
              class="box white-box-1-6 step-5"
              data-blue-step="41"
              data-red-step="28"
              data-yellow-step="2"
              data-green-step="15"
            ></div>
            <div
              class="box white-box-1-7 step-50"
              data-blue-step="34"
              data-red-step="21"
              data-yellow-step="47"
              data-green-step="8"
            ></div>
            <div class="box yellow-bg" data-yellow-step="54"></div>
            <div
              class="box white-box-1-8 step-6"
              data-blue-step="42"
              data-red-step="29"
              data-yellow-step="3"
              data-green-step="16"
            ></div>
            <div
              class="box white-box-1-9 step-49"
              data-blue-step="33"
              data-red-step="20"
              data-yellow-step="46"
              data-green-step="7"
            ></div>
            <div class="box yellow-bg" data-yellow-step="55"></div>
            <div
              class="box white-box-1-10 step-7"
              data-blue-step="43"
              data-red-step="30"
              data-yellow-step="4"
              data-green-step="17"
            ></div>
            <div
              class="box white-box-1-11 step-48"
              data-blue-step="32"
              data-red-step="19"
              data-yellow-step="45"
              data-green-step="6"
            ></div>
            <div class="box yellow-bg" data-yellow-step="56"></div>
            <div
              class="box white-box-1-12 step-8"
              data-blue-step="44"
              data-red-step="31"
              data-yellow-step="5"
              data-green-step="18"
            ></div>
          </div>
          <div class="yellow yellow-bg home">
            <div class="flash"></div>
            <div class="pins">
              <div
                class="pin yellow-bg-lighter yellow-pin-1 pin-in-parent-1"
              ></div>
              <div
                class="pin yellow-bg-lighter yellow-pin-2 pin-in-parent-2"
              ></div>
              <div
                class="pin yellow-bg-lighter yellow-pin-3 pin-in-parent-3"
              ></div>
              <div
                class="pin yellow-bg-lighter yellow-pin-4 pin-in-parent-4"
              ></div>
            </div>
          </div>
          <div class="middle-boxes 1">
            <div
              class="box white-box-2-1 step-42"
              data-blue-step="26"
              data-red-step="13"
              data-yellow-step="39"
            ></div>
            <div
              class="box green-bg step-43 green-startGame"
              data-blue-step="27"
              data-red-step="14"
              data-yellow-step="40"
              data-green-step="1"
            ></div>
            <div
              class="box white-box-2-2 step-44"
              data-blue-step="28"
              data-red-step="15"
              data-yellow-step="41"
              data-green-step="2"
            ></div>
            <div
              class="box white-box-2-3 step-45"
              data-blue-step="29"
              data-red-step="16"
              data-yellow-step="42"
              data-green-step="3"
            ></div>
            <div
              class="box white-box-2-4 step-46"
              data-blue-step="30"
              data-red-step="17"
              data-yellow-step="43"
              data-green-step="4"
            ></div>
            <div
              class="box white-box-2-5 step-47"
              data-blue-step="31"
              data-red-step="18"
              data-yellow-step="44"
              data-green-step="5"
            ></div>
            <div
              class="box white-box-2-6 step-41"
              data-blue-step="25"
              data-red-step="12"
              data-yellow-step="38"
              data-green-step="51"
              style="position: relative"
            >
              <i
                class="fa-solid fa-turn-down arrow-icon"
                style="margin-right: -100%; transform: rotateZ(-90deg)"
              ></i>
            </div>
            <div class="box green-bg" data-green-step="52"></div>
            <div class="box green-bg" data-green-step="53"></div>
            <div class="box green-bg" data-green-step="54"></div>
            <div class="box green-bg" data-green-step="55"></div>
            <div class="box green-bg" data-green-step="56"></div>
            <div
              class="box white-box-2-7 step-40"
              data-blue-step="24"
              data-red-step="11"
              data-yellow-step="37"
              data-green-step="50"
            ></div>
            <div
              class="box white-box-2-8 step-39"
              data-blue-step="23"
              data-red-step="10"
              data-yellow-step="36"
              data-green-step="49"
            ></div>
            <div
              class="box white-box-2-9 step-38"
              data-blue-step="22"
              data-red-step="9"
              data-yellow-step="35"
              data-green-step="48"
            ></div>
            <div
              class="box white-box-2-10 step-37"
              data-blue-step="21"
              data-red-step="8"
              data-yellow-step="34"
              data-green-step="47"
            ></div>
            <div
              class="box white-box-2-11 step-36"
              data-blue-step="20"
              data-red-step="7"
              data-yellow-step="33"
              data-green-step="46"
            ></div>
            <div
              class="box white-box-2-12 step-35"
              data-blue-step="19"
              data-red-step="6"
              data-yellow-step="32"
              data-green-step="45"
            ></div>
          </div>
          <div class="middle">
            <div class="dice-box" id="rool-dice" data-turn="">
              <div class="dice face-1">
                <div class="one dice-num"></div>
              </div>
              <div class="dice face-2">
                <div class="two dice-num"></div>
                <div class="two dice-num"></div>
              </div>
              <div class="dice face-3">
                <div class="three dice-num"></div>
                <div class="three dice-num"></div>
                <div class="three dice-num"></div>
              </div>
              <div class="dice face-4">
                <div class="four dice-num"></div>
                <div class="four dice-num"></div>
                <div class="four dice-num"></div>
                <div class="four dice-num"></div>
              </div>
              <div class="dice face-5">
                <div class="five dice-num"></div>
                <div class="five dice-num"></div>
                <div class="five dice-num"></div>
                <div class="five dice-num"></div>
                <div class="five dice-num"></div>
              </div>
              <div class="dice face-6">
                <div class="six dice-num"></div>
                <div class="six dice-num"></div>
                <div class="six dice-num"></div>
                <div class="six dice-num"></div>
                <div class="six dice-num"></div>
                <div class="six dice-num"></div>
              </div>
            </div>
          </div>
          <div class="middle-boxes 2">
            <div
              class="box white-box-3-1 step-9"
              data-blue-step="45"
              data-red-step="32"
              data-yellow-step="6"
              data-green-step="19"
            ></div>
            <div
              class="box white-box-3-2 step-10"
              data-blue-step="46"
              data-red-step="33"
              data-yellow-step="7"
              data-green-step="20"
            ></div>
            <div
              class="box white-box-3-3 step-11"
              data-blue-step="47"
              data-red-step="34"
              data-yellow-step="8"
              data-green-step="21"
            ></div>
            <div
              class="box white-box-3-4 step-12"
              data-blue-step="48"
              data-red-step="35"
              data-yellow-step="9"
              data-green-step="22"
            ></div>
            <div
              class="box white-box-3-5 step-13"
              data-blue-step="49"
              data-red-step="36"
              data-yellow-step="10"
              data-green-step="23"
            ></div>
            <div
              class="box white-box-3-6 step-14"
              data-blue-step="50"
              data-red-step="37"
              data-yellow-step="11"
              data-green-step="24"
            ></div>
            <div class="box blue-bg" data-blue-step="56"></div>
            <div class="box blue-bg" data-blue-step="55"></div>
            <div class="box blue-bg" data-blue-step="54"></div>
            <div class="box blue-bg" data-blue-step="53"></div>
            <div class="box blue-bg" data-blue-step="52"></div>
            <div
              class="box white-box-3-7 step-15"
              data-blue-step="51"
              data-red-step="38"
              data-yellow-step="12"
              data-green-step="25"
              style="position: relative"
            >
              <i
                class="fa-solid fa-turn-down arrow-icon"
                style="margin-left: -100%; transform: rotateZ(90deg)"
              ></i>
            </div>
            <div
              class="box white-box-3-8 step-21"
              data-blue-step="5"
              data-red-step="44"
              data-yellow-step="18"
              data-green-step="31"
            ></div>
            <div
              class="box white-box-3-9 step-20"
              data-blue-step="4"
              data-red-step="43"
              data-yellow-step="17"
              data-green-step="30"
            ></div>
            <div
              class="box white-box-3-10 step-19"
              data-blue-step="3"
              data-red-step="42"
              data-yellow-step="16"
              data-green-step="29"
            ></div>
            <div
              class="box white-box-3-11 step-18"
              data-blue-step="2"
              data-red-step="41"
              data-yellow-step="15"
              data-green-step="28"
            ></div>
            <div
              class="box blue-bg step-17"
              data-blue-step="1"
              data-red-step="40"
              data-yellow-step="14"
              data-green-step="27"
            ></div>
            <div
              class="box white-box-3-12 step-16"
              data-red-step="39"
              data-yellow-step="13"
              data-green-step="26"
            ></div>
          </div>
          <div class="red red-bg home">
            <div class="flash"></div>
            <div class="pins">
              <div class="pin red-bg-lighter red-pin-1 pin-in-parent-1"></div>
              <div class="pin red-bg-lighter red-pin-2 pin-in-parent-2"></div>
              <div class="pin red-bg-lighter red-pin-3 pin-in-parent-3"></div>
              <div class="pin red-bg-lighter red-pin-4 pin-in-parent-4"></div>
            </div>
          </div>
          <div class="boxes">
            <div
              class="box white-box-4-1 step-34"
              data-blue-step="18"
              data-red-step="5"
              data-yellow-step="31"
              data-green-step="44"
            ></div>
            <div class="box red-bg" data-red-step="56"></div>
            <div
              class="box white-box-4-2 step-22"
              data-blue-step="6"
              data-red-step="45"
              data-yellow-step="19"
              data-green-step="32"
            ></div>
            <div
              class="box white-box-4-3 step-33"
              data-blue-step="17"
              data-red-step="4"
              data-yellow-step="30"
              data-green-step="43"
            ></div>
            <div class="box red-bg" data-red-step="55"></div>
            <div
              class="box white-box-4-4 step-23"
              data-blue-step="7"
              data-red-step="46"
              data-yellow-step="20"
              data-green-step="33"
            ></div>
            <div
              class="box white-box-4-5 step-32"
              data-blue-step="16"
              data-red-step="3"
              data-yellow-step="29"
              data-green-step="42"
            ></div>
            <div class="box red-bg" data-red-step="54"></div>
            <div
              class="box white-box-4-6 step-24"
              data-blue-step="8"
              data-red-step="47"
              data-yellow-step="21"
              data-green-step="34"
            ></div>
            <div
              class="box white-box-4-7 step-31"
              data-blue-step="15"
              data-red-step="2"
              data-yellow-step="28"
              data-green-step="41"
            ></div>
            <div class="box red-bg" data-red-step="53"></div>
            <div
              class="box white-box-4-8 step-25"
              data-blue-step="9"
              data-red-step="48"
              data-yellow-step="22"
              data-green-step="35"
            ></div>
            <div
              class="box red-bg step-30"
              data-blue-step="14"
              data-red-step="1"
              data-yellow-step="27"
              data-green-step="40"
            ></div>
            <div class="box red-bg" data-red-step="52"></div>
            <div
              class="box white-box-4-9 step-26"
              data-blue-step="10"
              data-red-step="49"
              data-yellow-step="23"
              data-green-step="36"
            ></div>
            <div
              class="box white-box-4-10 step-29"
              data-blue-step="13"
              data-yellow-step="26"
              data-green-step="39"
            ></div>
            <div
              class="box white-box-4-11 step-28"
              data-blue-step="12"
              data-red-step="51"
              data-yellow-step="25"
              data-green-step="38"
              style="position: relative"
            >
              <i
                class="fa-solid fa-turn-up arrow-icon"
                style="margin-top: -100%; transform: rotateY(180deg)"
              ></i>
            </div>
            <div
              class="box white-box-4-12 step-27"
              data-blue-step="11"
              data-red-step="50"
              data-yellow-step="24"
              data-green-step="37"
            ></div>
          </div>
          <div class="blue blue-bg home">
            <div class="flash"></div>
            <div class="pins">
              <div class="pin blue-bg-lighter blue-pin-1 pin-in-parent-1"></div>
              <div class="pin blue-bg-lighter blue-pin-2 pin-in-parent-2"></div>
              <div class="pin blue-bg-lighter blue-pin-3 pin-in-parent-3"></div>
              <div class="pin blue-bg-lighter blue-pin-4 pin-in-parent-4"></div>
            </div>
          </div>
        </div>
        <div class="player-game-info">
          <div class="player player-3-info">
            <div class="player-cover player-3-cover"></div>
            <div class="winning-pins">
              <div class="win-pin win-red-pin pin"></div>
              <div class="win-pin win-red-pin pin"></div>
              <div class="win-pin win-red-pin pin"></div>
              <div class="win-pin win-red-pin pin"></div>
            </div>
            <div class="player-info">
              <p></p>
            </div>
          </div>
          <div class="player player-4-info">
            <div class="player-cover player-4-cover"></div>
            <div class="winning-pins">
              <div class="win-pin win-blue-pin pin"></div>
              <div class="win-pin win-blue-pin pin"></div>
              <div class="win-pin win-blue-pin pin"></div>
              <div class="win-pin win-blue-pin pin"></div>
            </div>
            <div class="player-info">
              <p></p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      let gameInfo = [];
      let listenerAdded = false;
      gameInfo["positions"] = [];
      let roolDiceTimer = 0;
      let playerName = "";
      let playerColor = "";
      let numberOfPlayers = "";
      let pausedMove = false;
      let players = [];
      let playAgainPlayers;
      let tracker = 0;
      let addClickEvent;
      let operating = false;
      let resetTransformation = 0;
      let clickRoolDice;
      let clickPlayAgain;
      const colorToPlayerNumber = [
        { color: "green", number: 1 },
        { color: "yellow", number: 2 },
        { color: "red", number: 3 },
        { color: "blue", number: 4 },
      ];
      function offlineMode() {
        document.getElementById("pop-up").innerHTML = `<div class="players">
              <button onclick="offlineVersion('Bot')">Play with Bot</button>
              <button onclick="offlineVersion('PlayPass')">Play n' Pass</button>
              <button onclick="mainMenu()"><i class="fa-solid fa-turn-up arrow-icon-2" style=" transform: rotateZ(-90deg);"></i></button>
            </div>`;
      }
      function displayColors() {
        if (gameInfo["offline-mode"]) {
          if (gameInfo["offline-mode"] === "PlayPass") {
          }
          // alert(gameInfo["offline-mode"])
        }
        if (numberOfPlayers == 4) {
          document.getElementById("pop-up").innerHTML = `<div class="color-pic">
              <p class="headers">Select your color</p>
              <div class="colors">
                <div class="input-color">
                  <label style="color: blue" for="blue">Blue</label>
                  <input
                  class="radio"
                    type="radio"
                    style="
                      accent-color: blue;
                      color: blue;
                      background-color: blue;
                    "
                    required
                    name="color"
                    value="blue"
                    id="blue"
                  />
                </div>
                <div class="input-color">
                  <label style="color: red" for="red">Red</label>
                  <input
                  class="radio"
                    type="radio"
                    style="accent-color: red; color: red; background-color: red"
                    required
                    name="color"
                    value="red"
                    id="red"
                  />
                </div>
                <div class="input-color">
                  <label style="color: yellow" for="yellow">Yellow</label>
                  <input
                  class="radio"
                    type="radio"
                    style="
                      accent-color: yellow;
                      color: yellow;
                      background-color: yellow;
                    "
                    required
                    name="color"
                    value="yellow"
                    id="yellow"
                  />
                </div>
                <div class="input-color">
                  <label style="color: green" for="green">Green</label>
                  <input
                  class="radio"
                    type="radio"
                    style="
                      accent-color: green;
                      color: green;
                      background-color: green;
                    "
                    required
                    name="color"
                    value="green"
                    id="green"
                  />
                </div>
              </div>
              <div class="controles">
                <button class="back-btn" onclick="NumberOfPlayers()"><i class="fa-solid fa-turn-up arrow-icon-2" style=" transform: rotateZ(-90deg);"></i></button>
                <button onclick='setPlayerColor(document.querySelector(".colors input[name=${"color"}]:checked").value)'>Next</button>
              </div>
            </div>`;
        } else {
          document.getElementById("pop-up").innerHTML = `<div class="color-pic">
                <p class="headers">Select your color</p>
                <div class="colors">
                  <div class="input-color">
                    <label style="display: flex; gap: 4px" for="blue-green"><p style="color: blue">Blue </p><p> - </p><p style="color: green"> Green</p></label>
                    <div class="input blue-green">
                      <input
                      class="radio-color"
                        type="radio"
                        style="
                          opacity: 0;
                        "
                        required
                        name="color"
                        value="blue-green"
                        id="blue-green"
                      />
                    </div>
                  </div>
                  <div class="input-color">
                    <label style="display: flex; gap: 4px" for="red-yellow"><p style="color: red">Red </p><p> - </p><p style="color: Yellow"> Yellow</p></label>
                    <div class="input red-yellow">
                      <input
                        class="radio-color"
                        type="radio"
                        style="opacity: 0"
                        required
                        name="color"
                        value="red-yellow"
                        id="red-yellow"
                    />
                    </div>
                  </div>
                  <div class="input-color">
                    <label style="display: flex; gap: 4px" for="green-yellow"><p style="color: green">Green </p><p> - </p><p style="color: Yellow"> Yellow</p></label>
                    <div class="input green-yellow">
                      <input
                        class="radio-color"
                        type="radio"
                        style="opacity: 0;"
                        required
                        name="color"
                        value="green-yellow"
                        id="green-yellow"
                    />
                    </div>
                  </div>
                  <div class="input-color">
                    <label style="display: flex; gap: 4px" for="green-red"><p style="color: green">Green </p><p> - </p><p style="color: red"> Red</p></label>
                    <div class="input green-red">
                      <input
                    class="radio-color"
                      type="radio"
                      style="opacity: 0"
                      required
                      name="color"
                      value="green-red"
                      id="green-red"
                    />
                    </div>
                  </div>
                  <div class="input-color">
                    <label style="display: flex; gap: 4px" for="red-blue"><p style="color: red">Red </p><p> - </p><p style="color: blue"> Blue</p></label>
                    <div class="input red-blue">
                      <input
                    class="radio-color"
                      type="radio"
                      style="opacity: 0"
                      required
                      name="color"
                      value="red-blue"
                      id="red-blue"
                    />
                    </div>
                  </div>
                  <div class="input-color">
                    <label style="display: flex; gap: 4px" for="blue-yellow"><p style="color: blue">Blue </p><p> - </p><p style="color: yellow"> Yellow</p></label>
                    <div class="input blue-yellow">
                      <input
                    class="radio-color"
                      type="radio"
                      style="opacity: 0"
                      required
                      name="color"
                      value="blue-yellow"
                      id="blue-yellow"
                    />
                    </div>
                  </div>
                </div>
                <div class="controles">
                  <button class="back-btn" onclick="NumberOfPlayers()"><i class="fa-solid fa-turn-up arrow-icon-2" style=" transform: rotateZ(-90deg);"></i></button>
                  <button onclick='setPlayerColor(document.querySelector(".colors input[name=${"color"}]:checked").value)'>Next</button>
                </div>
              </div>`;
        }
      }
      function offlineVersion(version) {
        gameInfo["offline-mode"] = version;
        if (version === "PlayPass") {
          NumberOfPlayers();
        } else if (version === "Bot") {
          NumberOfPlayers();
        }
      }
      function mainMenu() {
        if (players.length > 0) {
          players.length = 0;
          console.log(players);
          if (listenerAdded) {
            document
              .getElementById("rool-dice")
              .removeEventListener("click", clickRoolDice);
          }
          resetBoard();
        }
        document.getElementById("pop-up").innerHTML = `<div class="players">
              <button onclick="offlineMode()">Play Offline</button>
              <button>Play Online</button>
            </div>`;
      }
      function playerNames() {
        document.getElementById(
          "pop-up"
        ).innerHTML = `<div class='players-info players'>
        <div class='single-player-info player-1'>
          <input type='text' minlength='1' maxlength='23' placeholder='Enter your name' name='player-1' id='single-player-name'
            required />
            <div class='single-player-info-buttons'>
            <button class="back-btn" onclick="displayColors()"><i class="fa-solid fa-turn-up arrow-icon-2" style=" transform: rotateZ(-90deg);"></i></button>
            <button onclick="displayStart(document.getElementById('single-player-name').value)">Enter</button>
            </div>
        </div>
      </div>`;
      }
      function NumberOfPlayers() {
        document.getElementById("pop-up").innerHTML = `<div class="players-num">
        <p class="headers">Select players</p>
        <div class="options">
          <div class="option">
            <input
            class="radio-number"
              required
              type="radio"
              name="number-of-players"
              id="2"
              value="2"
            />
            <label for="2">2 Players</label>
          </div>
          <div class="option">
            <input
            class="radio-number"
              required
              type="radio"
              name="number-of-players"
              id="4"
              value="4"
            />
            <label for="4">4 Players</label>
          </div>
        </div>
        <div class='single-player-info-buttons'>
            <button class="back-btn" onclick="offlineMode()"><i class="fa-solid fa-turn-up arrow-icon-2" style=" transform: rotateZ(-90deg);"></i></button>
            <button onclick='setPlayerNumber(document.querySelector(".options input[name=${"number-of-players"}]:checked").value)'>Next</button>
        </div>
      </div>`;
      }
      function displayStart(playerName) {
        setPlayerName(playerName);
        document.getElementById("pop-up").innerHTML = `<div class="players">
              <button onclick="startGame('${playerName}')">Start</button>
            </div>`;
      }
      window.addEventListener("resize", () => {
        document.querySelectorAll(".pin").forEach((element) => {
          element.style.height = `${
            document.querySelector(".box").clientHeight
          }px`;
          element.style.width = `${
            document.querySelector(".box").clientWidth
          }px`;
        });
      });
      window.addEventListener("load", () => {
        document.querySelectorAll(".pin").forEach((element) => {
          element.style.height = `${
            document.querySelector(".box").clientHeight
          }px`;
          element.style.width = `${
            document.querySelector(".box").clientWidth
          }px`;
        });
      });
      let number2;
      function assignPlayers(A, B) {
        const opposition = { 1: 4, 4: 1, 2: 3, 3: 2 };
        const opponent = { 1: 2, 2: 1, 3: 4, 4: 3 };
        if (A != null) return opposition[A];
        else if (B != null) return opponent[B];
      }
      function assignBotColor(Colors) {
        const colors = ["blue", "red", "yellow", "green"];
        return colors.filter((s) => !Colors.includes(s));
      }
      function startGame(playerName) {
        if (numberOfPlayers == 2) {
          let playerANumber = 0;
          players.push({
            name: playerName,
            color1: playerColor[0],
            color2: playerColor[1],
          });
          const botColors = assignBotColor(playerColor);
          players.push({
            name: `Bot`,
            color1: botColors[0],
            color2: botColors[1],
          });
          for (let i = 0; i < colorToPlayerNumber.length; i++) {
            const element = colorToPlayerNumber[i];
            if (element.color == playerColor[0]) {
              document.querySelector(
                `.player-${element.number}-info p`
              ).innerText = playerName;
              // document.querySelector(
              //   `.player-${assignPlayers(element.number, null)}-info p`
              // ).innerText = playerName;
              continue;
            }
            if (element.color == playerColor[1]) {
              document.querySelector(
                `.player-${element.number}-info p`
              ).innerText = playerName;
              // document.querySelector(
              //   `.player-${assignPlayers(element.number, null)}-info p`
              // ).innerText = playerName;
              continue;
            }
            if (element.color == botColors[0]) {
              document.querySelector(
                `.player-${element.number}-info p`
              ).innerText = "Bot";
              // document.querySelector(
              //   `.player-${assignPlayers(element.number, null)}-info p`
              // ).innerText = "Bot";
              continue;
            }
            if (element.color == botColors[1]) {
              document.querySelector(
                `.player-${element.number}-info p`
              ).innerText = "Bot";
              // document.querySelector(
              //   `.player-${assignPlayers(element.number, null)}-info p`
              // ).innerText = "Bot";
              continue;
            }
          }
        } else if (numberOfPlayers == 4) {
          let botNumber = 0;
          for (let i = 0; i < colorToPlayerNumber.length; i++) {
            const element = colorToPlayerNumber[i];
            if (element.color == playerColor) {
              players.push({
                name: playerName,
                color: element.color,
                number: element.number,
              });
              document.querySelector(
                `.player-${element.number}-info p`
              ).innerText = playerName;
            } else {
              botNumber += 1;
              players.push({
                name: `Bot${botNumber}`,
                color: element.color,
                number: element.number,
              });
              document.querySelector(
                `.player-${element.number}-info p`
              ).innerText = `Bot${botNumber}`;
            }
          }
        }
        removeMenu();
        randomStartGame("with-AI", numberOfPlayers);
      }
      function setPlayerName(name) {
        playerName = name;
      }
      function setPlayerColor(color) {
        if (numberOfPlayers == 4) {
          playerColor = color;
        } else {
          playerColor = color.split("-");
        }
        playerNames();
      }
      function setPlayerNumber(amount) {
        numberOfPlayers = amount;
        displayColors();
      }
      function randomStartGame(playering, amount) {
        console.log(players);

        gameInfo["currentTurn"] = Math.floor(Math.random() * players.length);
        const randomStarter = players[gameInfo["currentTurn"]];
        const playerInfos = document.querySelectorAll(".player");
        for (let i = 0; i < playerInfos.length; i++) {
          let playerInfo = playerInfos[i];
          if (
            playerInfo.querySelector(".player-info p").innerText ==
            randomStarter.name
          ) {
            if (
              playerInfo.querySelector(".player-cover").style.display == "block"
            ) {
              playerInfo.querySelector(".player-cover").style.display = "none";
            } else {
              playerInfo.querySelector(".player-cover").style.display = "none";
            }
            continue;
          }
          playerInfo.querySelector(".player-cover").style.display = "block";
        }
        if (randomStarter.name === playerName) {
          document.querySelector(".board-cover").style.display = "none";
        } else {
          document.querySelector(".board-cover").style.display = "block";
        }
        if (randomStarter.color1) {
          document.querySelector(
            `.${randomStarter.color1} .flash`
          ).style.display = "block";
          document.querySelector(
            `.${randomStarter.color2} .flash`
          ).style.display = "block";
        } else {
          document.querySelector(
            `.${randomStarter.color} .flash`
          ).style.display = "block";
        }

        if (randomStarter.name == playerName) {
          if (randomStarter.color1) {
            document
              .querySelector(`.${randomStarter.color1} .flash`)
              .classList.add("flash2");
            document
              .querySelector(`.${randomStarter.color2} .flash`)
              .classList.add("flash2");
          } else {
            document
              .querySelector(`.${randomStarter.color} .flash`)
              .classList.add("flash2");
          }
          operating = false;
          let message = `You're starting the game`;
          const timeOut = message.length * 100;
          alertPlayer("block", message);
          setTimeout(() => {
            pausedMove = false;
            listenerAdded = true;
            roolDice(randomStarter);
            operating = true;
            clickRoolDice = () => {
              roolDice(randomStarter);
            };
            document
              .getElementById("rool-dice")
              .addEventListener("click", clickRoolDice);
          }, timeOut);

          console.log(`You're starting the game`);
          console.log(randomStarter);
        } else {
          const userPlayer = players.find(
            (player) => player.name === playerName
          );
          if (userPlayer.hasOwnProperty("color2")) {
            document
              .querySelector(`.${userPlayer.color1} .flash`)
              .classList.add("flash2");
            document
              .querySelector(`.${userPlayer.color2} .flash`)
              .classList.add("flash2");
          } else {
            document
              .querySelector(`.${userPlayer.color} .flash`)
              .classList.add("flash2");
          }
          operating = true;
          let message = `${randomStarter.name} is starting the game`;
          const timeOut = message.length * 100;
          alertPlayer("block", message);
          const playerInfo = players.find(
            (player) => player.name === playerName
          );
          setTimeout(() => {
            pausedMove = false;
            roolDice(randomStarter);
            listenerAdded = true;

            clickRoolDice = () => {
              roolDice(playerInfo);
            };
            document
              .getElementById("rool-dice")
              .addEventListener("click", clickRoolDice);
          }, timeOut);

          console.log(playerInfo);
        }
      }
      function switchTurns(currentTurn, playAgain = false) {
        let currentPlayerInfo = "";
        let nextPlayerInfo = "";
        console.log(players);
        console.log(gameInfo["currentTurn"]);

        if (players.length == 2) {
          if (playAgain) {
            currentPlayerInfo = players.find(
              (player) => player.name !== players[gameInfo["currentTurn"]].name
            );
            nextPlayerInfo = players[gameInfo["currentTurn"]];
          } else {
            currentPlayerInfo = players[gameInfo["currentTurn"]];
            nextPlayerInfo = players.find(
              (player) => player.name !== players[gameInfo["currentTurn"]].name
            );
            gameInfo["currentTurn"] = players.findIndex(
              (player) => player.name === nextPlayerInfo.name
            );
          }
          if (currentPlayerInfo != "" && nextPlayerInfo != "") {
            const playerInfos = document.querySelectorAll(".player");
            for (let i = 0; i < playerInfos.length; i++) {
              let playerInfo = playerInfos[i];
              if (
                playerInfo.querySelector(".player-info p").innerText ==
                nextPlayerInfo.name
              ) {
                if (
                  playerInfo.querySelector(".player-cover").style.display ==
                  "block"
                ) {
                  playerInfo.querySelector(".player-cover").style.display =
                    "none";
                } else {
                  playerInfo.querySelector(".player-cover").style.display =
                    "none";
                }
                continue;
              }
              playerInfo.querySelector(".player-cover").style.display = "block";
            }
            if (nextPlayerInfo.name === playerName) {
              document.querySelector(".board-cover").style.display = "none";
            } else {
              document.querySelector(".board-cover").style.display = "block";
            }
            if (currentPlayerInfo.color1) {
              if (
                document.querySelector(`.${currentPlayerInfo.color1} .flash`)
                  .style.display == "block" &&
                document.querySelector(`.${currentPlayerInfo.color2} .flash`)
                  .style.display == "block"
              ) {
                document.querySelector(
                  `.${currentPlayerInfo.color1} .flash`
                ).style.display = "none";
                document.querySelector(
                  `.${currentPlayerInfo.color2} .flash`
                ).style.display = "none";
                document.querySelector(
                  `.${nextPlayerInfo.color1} .flash`
                ).style.display = "block";
                document.querySelector(
                  `.${nextPlayerInfo.color2} .flash`
                ).style.display = "block";
              } else {
                document.querySelector(
                  `.${nextPlayerInfo.color1} .flash`
                ).style.display = "block";
                document.querySelector(
                  `.${nextPlayerInfo.color2} .flash`
                ).style.display = "block";
              }
            } else {
              if (
                document.querySelector(`.${currentPlayerInfo.color} .flash`)
                  .style.display == "block"
              ) {
                document.querySelector(
                  `.${currentPlayerInfo.color} .flash`
                ).style.display = "none";
                document.querySelector(
                  `.${nextPlayerInfo.color} .flash`
                ).style.display = "block";
              } else {
                document.querySelector(
                  `.${nextPlayerInfo.color} .flash`
                ).style.display = "block";
              }
            }
          }
        } else if (players.length == 4) {
          if (players[parseInt(gameInfo["currentTurn"])].color == "blue") {
            if (playAgain) {
              currentPlayerInfo = players.find(
                (player) => player.color === "yellow"
              );
              nextPlayerInfo = players.find(
                (player) => player.color === "blue"
              );
            } else {
              currentPlayerInfo = players[parseInt(gameInfo["currentTurn"])];
              nextPlayerInfo = players.find((player) => player.color === "red");
              gameInfo["currentTurn"] = nextPlayerInfo.number - 1;
            }
          } else if (
            players[parseInt(gameInfo["currentTurn"])].color == "red"
          ) {
            if (playAgain) {
              currentPlayerInfo = players.find(
                (player) => player.color === "blue"
              );
              nextPlayerInfo = players.find((player) => player.color === "red");
            } else {
              currentPlayerInfo = players[parseInt(gameInfo["currentTurn"])];
              nextPlayerInfo = players.find(
                (player) => player.color === "green"
              );
              gameInfo["currentTurn"] = nextPlayerInfo.number - 1;
            }
          } else if (
            players[parseInt(gameInfo["currentTurn"])].color == "green"
          ) {
            if (playAgain) {
              currentPlayerInfo = players.find(
                (player) => player.color === "red"
              );
              nextPlayerInfo = players.find(
                (player) => player.color === "green"
              );
            } else {
              currentPlayerInfo = players[parseInt(gameInfo["currentTurn"])];
              nextPlayerInfo = players.find(
                (player) => player.color === "yellow"
              );
              gameInfo["currentTurn"] = nextPlayerInfo.number - 1;
            }
          } else if (
            players[parseInt(gameInfo["currentTurn"])].color == "yellow"
          ) {
            if (playAgain) {
              currentPlayerInfo = players.find(
                (player) => player.color === "green"
              );
              nextPlayerInfo = players.find(
                (player) => player.color === "yellow"
              );
            } else {
              currentPlayerInfo = players[parseInt(gameInfo["currentTurn"])];
              nextPlayerInfo = players.find(
                (player) => player.color === "blue"
              );
              gameInfo["currentTurn"] = nextPlayerInfo.number - 1;
            }
          }
          if (currentPlayerInfo != "" && nextPlayerInfo != "") {
            const playerInfos = document.querySelectorAll(".player");
            for (let i = 0; i < playerInfos.length; i++) {
              let playerInfo = playerInfos[i];
              if (
                playerInfo.querySelector(".player-info p").innerText ==
                nextPlayerInfo.name
              ) {
                if (
                  playerInfo.querySelector(".player-cover").style.display ==
                  "block"
                ) {
                  playerInfo.querySelector(".player-cover").style.display =
                    "none";
                } else {
                  playerInfo.querySelector(".player-cover").style.display =
                    "none";
                }
                continue;
              }
              playerInfo.querySelector(".player-cover").style.display = "block";
            }
            if (nextPlayerInfo.name === playerName) {
              document.querySelector(".board-cover").style.display = "none";
            } else {
              document.querySelector(".board-cover").style.display = "block";
            }
            if (
              document.querySelector(`.${currentPlayerInfo.color} .flash`).style
                .display == "block"
            ) {
              document.querySelector(
                `.${currentPlayerInfo.color} .flash`
              ).style.display = "none";
              document.querySelector(
                `.${nextPlayerInfo.color} .flash`
              ).style.display = "block";
            } else {
              document.querySelector(
                `.${nextPlayerInfo.color} .flash`
              ).style.display = "block";
            }
          }
        } else if (players.length == 3) {
          if (players[parseInt(gameInfo["currentTurn"])].color == "blue") {
            if (playAgain) {
              if (players.find((player) => player.color === "yellow")) {
                currentPlayerInfo = players.find(
                  (player) => player.color === "yellow"
                );
              } else {
                currentPlayerInfo = players.find(
                  (player) => player.color === "green"
                );
              }
              nextPlayerInfo = players.find(
                (player) => player.color === "blue"
              );
            } else {
              currentPlayerInfo = players[parseInt(gameInfo["currentTurn"])];
              if (players.find((player) => player.color === "red")) {
                nextPlayerInfo = players.find(
                  (player) => player.color === "red"
                );
              } else {
                nextPlayerInfo = players.find(
                  (player) => player.color === "green"
                );
              }
              gameInfo["currentTurn"] = players.findIndex(
                (player) => player.name === nextPlayerInfo.name
              );
            }
          } else if (
            players[parseInt(gameInfo["currentTurn"])].color == "red"
          ) {
            if (playAgain) {
              if (players.find((player) => player.color === "blue")) {
                currentPlayerInfo = players.find(
                  (player) => player.color === "blue"
                );
              } else {
                currentPlayerInfo = players.find(
                  (player) => player.color === "yellow"
                );
              }
              nextPlayerInfo = players.find((player) => player.color === "red");
            } else {
              currentPlayerInfo = players[parseInt(gameInfo["currentTurn"])];
              if (players.find((player) => player.color === "green")) {
                nextPlayerInfo = players.find(
                  (player) => player.color === "green"
                );
              } else {
                nextPlayerInfo = players.find(
                  (player) => player.color === "yellow"
                );
              }
              gameInfo["currentTurn"] = players.findIndex(
                (player) => player.name === nextPlayerInfo.name
              );
            }
          } else if (
            players[parseInt(gameInfo["currentTurn"])].color == "green"
          ) {
            if (playAgain) {
              if (players.find((player) => player.color === "red")) {
                currentPlayerInfo = players.find(
                  (player) => player.color === "red"
                );
              } else {
                currentPlayerInfo = players.find(
                  (player) => player.color === "blue"
                );
              }
              nextPlayerInfo = players.find(
                (player) => player.color === "green"
              );
            } else {
              currentPlayerInfo = players[parseInt(gameInfo["currentTurn"])];
              if (players.find((player) => player.color === "yellow")) {
                nextPlayerInfo = players.find(
                  (player) => player.color === "yellow"
                );
              } else {
                nextPlayerInfo = players.find(
                  (player) => player.color === "blue"
                );
              }
              gameInfo["currentTurn"] = players.findIndex(
                (player) => player.name === nextPlayerInfo.name
              );
            }
          } else if (
            players[parseInt(gameInfo["currentTurn"])].color == "yellow"
          ) {
            if (playAgain) {
              if (players.find((player) => player.color === "green")) {
                currentPlayerInfo = players.find(
                  (player) => player.color === "green"
                );
              } else {
                currentPlayerInfo = players.find(
                  (player) => player.color === "red"
                );
              }
              nextPlayerInfo = players.find(
                (player) => player.color === "yellow"
              );
            } else {
              currentPlayerInfo = players[parseInt(gameInfo["currentTurn"])];
              if (players.find((player) => player.color === "blue")) {
                nextPlayerInfo = players.find(
                  (player) => player.color === "blue"
                );
              } else {
                nextPlayerInfo = players.find(
                  (player) => player.color === "red"
                );
              }
              gameInfo["currentTurn"] = players.findIndex(
                (player) => player.name === nextPlayerInfo.name
              );
            }
          }
          if (currentPlayerInfo != "" && nextPlayerInfo != "") {
            const playerInfos = document.querySelectorAll(".player");
            for (let i = 0; i < playerInfos.length; i++) {
              let playerInfo = playerInfos[i];
              if (
                playerInfo.querySelector(".player-info p").innerText ==
                nextPlayerInfo.name
              ) {
                if (
                  playerInfo.querySelector(".player-cover").style.display ==
                  "block"
                ) {
                  playerInfo.querySelector(".player-cover").style.display =
                    "none";
                } else {
                  playerInfo.querySelector(".player-cover").style.display =
                    "none";
                }
                continue;
              }
              playerInfo.querySelector(".player-cover").style.display = "block";
            }
            if (nextPlayerInfo.name === playerName) {
              document.querySelector(".board-cover").style.display = "none";
            } else {
              document.querySelector(".board-cover").style.display = "block";
            }
            if (
              document.querySelector(`.${currentPlayerInfo.color} .flash`).style
                .display == "block"
            ) {
              document.querySelector(
                `.${currentPlayerInfo.color} .flash`
              ).style.display = "none";
              document.querySelector(
                `.${nextPlayerInfo.color} .flash`
              ).style.display = "block";
            } else {
              document.querySelector(
                `.${nextPlayerInfo.color} .flash`
              ).style.display = "block";
            }
          }
        }
        if (currentPlayerInfo != "" && nextPlayerInfo != "") {
          if (
            currentPlayerInfo.name == playerName &&
            nextPlayerInfo.name != playerName
          ) {
            operating = true;
            document.getElementById("rool-dice").removeAttribute("data-turn");
            let message = `${nextPlayerInfo.name}'s turn`;
            if (playAgain === true) {
              message = `${nextPlayerInfo.name} rools dice again`;
            }
            const timeOut = message.length * 100;
            alertPlayer("block", message);
            setTimeout(() => {
              aiMove(nextPlayerInfo);
            }, timeOut);
          } else if (
            currentPlayerInfo.name != playerName &&
            nextPlayerInfo.name != playerName
          ) {
            operating = true;
            document.getElementById("rool-dice").removeAttribute("data-turn");
            let message = `${nextPlayerInfo.name}'s turn`;
            if (playAgain === true) {
              message = `${nextPlayerInfo.name} rools dice again`;
            }
            const timeOut = message.length * 100;
            alertPlayer("block", message);
            setTimeout(() => {
              aiMove(nextPlayerInfo);
            }, timeOut);
          } else if (
            currentPlayerInfo.name != playerName &&
            nextPlayerInfo.name == playerName
          ) {
            operating = true;
            document
              .getElementById("rool-dice")
              .setAttribute("data-turn", nextPlayerInfo.name);
            let message = "Your turn";
            if (playAgain === true) {
              message = `Rool dice again`;
            }
            const timeOut = message.length * 100;
            alertPlayer("block", message);
            setTimeout(() => {
              operating = false;
            }, timeOut);
          }
        }
      }
      function removeMenu() {
        document.querySelector(".pop-up-cover").style.display = "none";
      }
      function displayMenu() {
        document.querySelector(".pop-up-cover").style.display = " flex";
      }
      function aiMove(bot) {
        operating = true;
        roolDice(bot);
      }
      function CheakBoxesLeft(color, number, pin) {
        const pinColor = pin.classList[1].split("-")[0];
        if (pin.parentElement.hasAttribute(`data-${pinColor}-step`)) {
          let currentStep = parseInt(
            pin.parentElement.getAttribute(`data-${pinColor}-step`)
          );
          if (currentStep + number > 57) {
            return false;
          } else if (currentStep + number == 57) {
            return "Goal";
          } else {
            return true;
          }
        } else {
          return true;
        }
      }
      function getPlayedPin(color) {
        if (Array.isArray(color)) {
          let boxes1 = document.querySelectorAll(`.box[data-${color[0]}-step]`);
          for (let i = 0; i < boxes1.length; i++) {
            if (
              boxes1[i].querySelector(".pin") &&
              boxes1[i]
                .querySelector(".pin")
                .classList.contains(`${color[0]}-bg-lighter`)
            ) {
              return boxes1[i];
            }
          }
          let boxes2 = document.querySelectorAll(`.box[data-${color[1]}-step]`);
          for (let i = 0; i < boxes2.length; i++) {
            if (
              boxes2[i].querySelector(".pin") &&
              boxes2[i]
                .querySelector(".pin")
                .classList.contains(`${color[1]}-bg-lighter`)
            ) {
              return boxes2[i];
            }
          }
        } else {
          let boxes = document.querySelectorAll(`.box[data-${color}-step]`);
          for (let i = 0; i < boxes.length; i++) {
            if (
              boxes[i].querySelector(".pin") &&
              boxes[i]
                .querySelector(".pin")
                .classList.contains(`${color}-bg-lighter`)
            ) {
              return boxes[i];
            }
          }
        }
      }
      function pinPlayed(color, alowedNumber = "") {
        let amountOfPins = 0;
        if (Array.isArray(color)) {
          let boxes1 = document.querySelectorAll(`.box[data-${color[0]}-step]`);
          let boxes2 = document.querySelectorAll(`.box[data-${color[1]}-step]`);
          for (let i = 0; i < boxes1.length; i++) {
            if (
              boxes1[i].querySelector(".pin") &&
              boxes1[i]
                .querySelector(".pin")
                .classList.contains(`${color[0]}-bg-lighter`)
            ) {
              if (boxes1[i].querySelectorAll(".pin").length > 1) {
                amountOfPins += boxes1[i].querySelectorAll(".pin").length;
              } else {
                amountOfPins += 1;
              }
            }
          }
          for (let i = 0; i < boxes2.length; i++) {
            if (
              boxes2[i].querySelector(".pin") &&
              boxes2[i]
                .querySelector(".pin")
                .classList.contains(`${color[1]}-bg-lighter`)
            ) {
              if (boxes2[i].querySelectorAll(".pin").length > 1) {
                amountOfPins += boxes2[i].querySelectorAll(".pin").length;
              } else {
                amountOfPins += 1;
              }
            }
          }
        } else {
          let boxes = document.querySelectorAll(`.box[data-${color}-step]`);
          for (let i = 0; i < boxes.length; i++) {
            if (
              boxes[i].querySelector(".pin") &&
              boxes[i]
                .querySelector(".pin")
                .classList.contains(`${color}-bg-lighter`)
            ) {
              if (boxes[i].querySelectorAll(".pin").length > 1) {
                amountOfPins += boxes[i].querySelectorAll(".pin").length;
              } else {
                amountOfPins += 1;
              }
            }
          }
        }
        if (alowedNumber == 1) {
          if (amountOfPins == 1) {
            return true;
          } else {
            return false;
          }
        } else {
          if (amountOfPins > 0) {
            return true;
          } else {
            return false;
          }
        }
      }
      function morePinsLeftHome(color) {
        if (Array.isArray(color)) {
          const pins1 = document.querySelectorAll(
            `.${color[0]} .pins .${color[0]}-bg-lighter`
          );
          const pins2 = document.querySelectorAll(
            `.${color[1]} .pins .${color[1]}-bg-lighter`
          );

          if (pins1.length > 0 || pins2.length > 0) {
            return true;
          } else {
            return false;
          }
        } else {
          const pins = document.querySelectorAll(
            `.${color} .pins .${color}-bg-lighter`
          );
          if (pins.length > 0) {
            return true;
          } else {
            return false;
          }
        }
      }
      function gameAlgorithm(number, color, turn) {
        if (operating == true) {
          const timeOut = (200 + 200) * number;
          if (!pinPlayed(color)) {
            if (number == 6) {
              tracker += 1;
              if (turn && turn.name != playerName) {
                pausedMove = false;
                let randomPin = pickRandomPin(color);
                if (randomPin) {
                  if (
                    checkOpponentPin(
                      color,
                      document.querySelector(
                        `.box[data-${
                          randomPin.classList[1].split("-")[0]
                        }-step="1"]`
                      ),
                      false
                    )
                  ) {
                    let eliminatingColor = checkOpponentPin(
                      color,
                      document.querySelector(
                        `.box[data-${
                          randomPin.classList[1].split("-")[0]
                        }-step="1"]`
                      ),
                      false
                    );
                    pinAnimation(
                      turn,
                      randomPin,
                      randomPin.parentElement,
                      number,
                      randomPin.classList[1].split("-")[0],
                      "move-out"
                    );
                    operating = true;
                    setTimeout(() => {
                      movePinHome(eliminatingColor, 0, turn, randomPin);
                      resizePinForGoal(
                        randomPin,
                        eliminatingColor,
                        number,
                        turn
                      );
                    }, 600);
                  } else {
                    console.log("new entry");
                    pinAnimation(
                      turn,
                      randomPin,
                      randomPin.parentElement,
                      number,
                      randomPin.classList[1].split("-")[0],
                      "move-out"
                    );
                    operating = true;
                    setTimeout(() => {
                      randomPin.classList.add("pin-in-box");
                      operating = true;
                      switchTurns(turn, true);
                    }, 600);
                  }
                }
              } else {
                operating = true;
                addClickEvent = (event) => {
                  pickedPin(event.currentTarget, color, number, turn, event);
                };
                if (Array.isArray(color)) {
                  pausedMove = true;
                  document
                    .querySelectorAll(`.${color[0]}-bg-lighter`)
                    .forEach((element) => {
                      element.classList.add("hover-pin");
                      element.addEventListener("click", addClickEvent, {
                        once: true,
                      });
                    });
                  document
                    .querySelectorAll(`.${color[1]}-bg-lighter`)
                    .forEach((element) => {
                      element.classList.add("hover-pin");
                      element.addEventListener("click", addClickEvent, {
                        once: true,
                      });
                    });
                } else {
                  console.log("no color array");

                  let pin = pickRandomPin(color);
                  if (!pin.parentElement.getAttribute(`data-${color}-step`)) {
                    if (
                      checkOpponentPin(
                        color,
                        document.querySelector(`.box[data-${color}-step="1"]`),
                        false
                      )
                    ) {
                      pinAnimation(
                        turn,
                        pin,
                        pin.parentElement,
                        number,
                        color,
                        "move-out"
                      );
                      setTimeout(() => {
                        operating = true;
                        movePinHome(color, 0, turn, pin);
                        resizePinForGoal(pin, color, number, turn);
                      }, 600);
                    } else {
                      pinAnimation(
                        turn,
                        pin,
                        pin.parentElement,
                        number,
                        color,
                        "move-out"
                      );
                      operating = true;
                      setTimeout(() => {
                        pin.classList.add("pin-in-box");
                        movePinHome(color, 0, turn, pin);

                        operating = true;
                        switchTurns(turn, true);
                      }, 600);
                    }
                  }
                }
              }
            } else if (number < 6) {
              if (turn && turn.name != playerName) {
                // operating = false;
                switchTurns(turn, false);
              } else {
                operating = true;
                switchTurns(turn, false);
              }
            }
          } else if (pinPlayed(color)) {
            if (number == 6) {
              tracker += 1;
              if (turn) {
                if (turn.name != playerName) {
                  let randomPin = pickRandomPin(color);
                  if (randomPin) {
                    if (
                      checkOpponentPin(
                        color,
                        document.querySelector(
                          `.box[data-${
                            randomPin.classList[1].split("-")[0]
                          }-step="1"]`
                        ),
                        false
                      )
                    ) {
                      pinAnimation(
                        turn,
                        randomPin,
                        randomPin.parentElement,
                        number,
                        randomPin.classList[1].split("-")[0],
                        "move-out"
                      );
                      setTimeout(() => {
                        operating = true;
                        movePinHome(color, 0, turn, randomPin);
                        resizePinForGoal(randomPin, color, number, turn);
                      }, 400);
                    } else {
                      // movePinHome(color, 0, turn, randomPin);
                      adjustPinSize(
                        color,
                        null,
                        document.querySelector(
                          `.box[data-${
                            randomPin.classList[1].split("-")[0]
                          }-step="1"]`
                        ),
                        randomPin
                      );
                      pinAnimation(
                        turn,
                        randomPin,
                        randomPin.parentElement,
                        number,
                        randomPin.classList[1].split("-")[0],
                        "move-out"
                      );
                      operating = true;
                      setTimeout(() => {
                        randomPin.classList.add("pin-in-box");
                        operating = true;
                        switchTurns(turn, true);
                      }, 600);
                    }
                  } else {
                    pausedMove = false;
                    aiAlgorithm(number, color, turn);
                  }
                } else {
                  if (!morePinsLeftHome(color) && pinPlayed(color, 1)) {
                    const lastBox = getPlayedPin(color);
                    let lastPin = lastBox.querySelector(".pin");
                    let currentColorStep = parseInt(
                      lastBox.getAttribute(
                        `data-${lastPin.classList[1].split("-")[0]}-step`
                      )
                    );
                    // if(Array.isArray(color)){
                    //   currentColorStep
                    // }
                    if (CheakBoxesLeft(color, number, lastPin) === true) {
                      if (
                        checkOpponentPin(
                          color,
                          document.querySelector(
                            `.box[data-${
                              lastPin.classList[1].split("-")[0]
                            }-step="${currentColorStep + number}"]`
                          ),
                          false
                        )
                      ) {
                        pinAnimation(
                          turn,
                          lastPin,
                          lastPin.parentElement,
                          number,
                          lastPin.classList[1].split("-")[0]
                        );
                        setTimeout(() => {
                          operating = true;
                          movePinHome(
                            color,
                            currentColorStep + number - 1,
                            turn,
                            lastPin
                          );
                          resizePinForGoal(lastPin, color, number, turn);
                        }, timeOut);
                      } else {
                        pinAnimation(
                          turn,
                          lastPin,
                          lastPin.parentElement,
                          number,
                          lastPin.classList[1].split("-")[0]
                        );
                        operating = true;
                        setTimeout(() => {
                          operating = true;
                          switchTurns(turn, true);
                        }, timeOut);
                      }
                    } else if (
                      CheakBoxesLeft(color, number, lastPin) === "Goal"
                    ) {
                      pinAnimation(
                        turn,
                        lastPin,
                        lastPin.parentElement,
                        number,
                        lastPin.classList[1].split("-")[0]
                      );
                      setTimeout(() => {
                        operating = true;
                        resizePinForGoal(lastPin, color, number, turn);
                      }, timeOut);
                    } else {
                      operating = true;
                      switchTurns(turn, true);
                    }
                  } else {
                    pausedMove = true;
                    operating = true;
                    addClickEvent = (event) => {
                      pickedPin(
                        event.currentTarget,
                        color,
                        number,
                        turn,
                        event
                      );
                    };
                    if (Array.isArray(color)) {
                      document
                        .querySelectorAll(`.${color[0]}-bg-lighter`)
                        .forEach((element) => {
                          element.classList.add("hover-pin");
                          element.addEventListener("click", addClickEvent, {
                            once: true,
                          });
                        });
                      document
                        .querySelectorAll(`.${color[1]}-bg-lighter`)
                        .forEach((element) => {
                          element.classList.add("hover-pin");
                          element.addEventListener("click", addClickEvent, {
                            once: true,
                          });
                        });
                    } else {
                      document
                        .querySelectorAll(`.${color}-bg-lighter`)
                        .forEach((element2) => {
                          element2.classList.add("hover-pin");
                          element2.addEventListener("click", addClickEvent, {
                            once: true,
                          });
                        });
                    }
                    // switchTurns(turn, true);
                  }
                }
              }
            } else if (number < 6) {
              if (turn && turn.name != playerName) {
                pausedMove = false;
                console.log(number);

                aiAlgorithm(number, color, turn);
                // switchTurns(turn, false);
              } else {
                console.log(pausedMove);

                if (pinPlayed(color, 1)) {
                  let box = getPlayedPin(color);
                  console.log(box);

                  let pin = box.querySelector(".pin");
                  let currentColorStep = parseInt(
                    box.getAttribute(
                      `data-${pin.classList[1].split("-")[0]}-step`
                    )
                  );
                  if (
                    checkOpponentPin(
                      color,
                      document.querySelector(
                        `.box[data-${pin.classList[1].split("-")[0]}-step="${
                          currentColorStep + number
                        }"]`
                      ),
                      false
                    )
                  ) {
                    pinAnimation(
                      turn,
                      pin,
                      pin.parentElement,
                      number,
                      pin.classList[1].split("-")[0]
                    );
                    setTimeout(() => {
                      operating = true;
                      movePinHome(
                        color,
                        currentColorStep + number - 1,
                        turn,
                        pin
                      );
                      resizePinForGoal(pin, color, number, turn);
                    }, timeOut);
                  } else {
                    if (CheakBoxesLeft(color, number, pin) === true) {
                      pinAnimation(
                        turn,
                        pin,
                        pin.parentElement,
                        number,
                        pin.classList[1].split("-")[0]
                      );
                      operating = true;
                      setTimeout(() => {
                        operating = true;
                        switchTurns(turn, false);
                      }, timeOut);
                    } else if (CheakBoxesLeft(color, number, pin) === "Goal") {
                      pinAnimation(
                        turn,
                        pin,
                        pin.parentElement,
                        number,
                        pin.classList[1].split("-")[0]
                      );
                      setTimeout(() => {
                        operating = true;
                        resizePinForGoal(pin, color, number, turn);
                      }, timeOut);
                    } else {
                      operating = true;
                      switchTurns(turn, false);
                    }
                  }
                } else {
                  pausedMove = true;
                  operating = true;
                  addClickEvent = (event) => {
                    pickedPin(event.currentTarget, color, number, turn, event);
                  };
                  if (Array.isArray(color)) {
                    document
                      .querySelectorAll(`.box .${color[0]}-bg-lighter`)
                      .forEach((element) => {
                        element.classList.add("hover-pin");
                        element.addEventListener("click", addClickEvent, {
                          once: true,
                        });
                      });

                    document
                      .querySelectorAll(`.box .${color[1]}-bg-lighter`)
                      .forEach((element) => {
                        element.classList.add("hover-pin");
                        element.addEventListener("click", addClickEvent, {
                          once: true,
                        });
                      });
                  } else {
                    document
                      .querySelectorAll(`.box .${color}-bg-lighter`)
                      .forEach((element) => {
                        element.classList.add("hover-pin");
                        element.addEventListener("click", addClickEvent, {
                          once: true,
                        });
                      });
                  }
                }
              }
            }
          }
        }
      }
      function pickRandomPin(color) {
        let pins = [];
        if (Array.isArray(color)) {
          document
            .querySelectorAll(`.${color[0]} .pins .pin`)
            .forEach((pin) => {
              pins.push(pin);
            });
          document
            .querySelectorAll(`.${color[1]} .pins .pin`)
            .forEach((pin) => {
              pins.push(pin);
            });
        } else {
          document.querySelectorAll(`.${color} .pins .pin`).forEach((pin) => {
            pins.push(pin);
          });
        }
        if (pins.length > 0) {
          const randomPin = pins[Math.floor(Math.random() * pins.length)];
          return randomPin;
        } else {
          return false;
        }
      }
      function pickedPin(element, pickedColor, number, currentTurn, e) {
        operating = true;
        pausedMove = false;
        e.stopPropagation();
        const timeOut = (200 + 200) * number;
        const color = element.classList[1].split("-")[0];
        if (Array.isArray(pickedColor)) {
          document
            .querySelectorAll(`.${pickedColor[0]}-bg-lighter`)
            .forEach((element) => {
              element.classList.remove("hover-pin");
              element.removeEventListener("click", addClickEvent, {
                once: true,
              });
              console.log("removed Event listeener and hover pin class");
            });
          document
            .querySelectorAll(`.${pickedColor[1]}-bg-lighter`)
            .forEach((element) => {
              element.classList.remove("hover-pin");
              element.removeEventListener("click", addClickEvent, {
                once: true,
              });
              console.log("removed Event listeener and hover pin class");
            });
        } else {
          document
            .querySelectorAll(`.${color}-bg-lighter`)
            .forEach((element) => {
              element.classList.remove("hover-pin");
              element.removeEventListener("click", addClickEvent, {
                once: true,
              });
              console.log("removed Event listeener and hover pin class");
            });
        }
        if (CheakBoxesLeft(pickedColor, number, element) == true) {
          if (number == 6) {
            alertPlayer("block", `${currentTurn.name} rools dice again`);
            tracker += 1;
            console.log(tracker);
            if (element.classList[2]) {
              console.log(element.parentElement);
              if (!element.parentElement.getAttribute(`data-${color}-step`)) {
                if (
                  checkOpponentPin(
                    pickedColor,
                    document.querySelector(`.box[data-${color}-step="1"]`),
                    false
                  )
                ) {
                  pinAnimation(
                    currentTurn,
                    element,
                    element.parentElement,
                    number,
                    color,
                    "move-out"
                  );
                  setTimeout(() => {
                    operating = true;
                    movePinHome(pickedColor, 0, currentTurn, element);
                    resizePinForGoal(element, pickedColor, number, currentTurn);
                  }, 600);
                } else {
                  adjustPinSize(
                    pickedColor,
                    null,
                    document.querySelector(`.box[data-${color}-step="1"]`),
                    element
                  );
                  pinAnimation(
                    currentTurn,
                    element,
                    element.parentElement,
                    number,
                    color,
                    "move-out"
                  );
                  operating = true;
                  setTimeout(() => {
                    operating = true;
                    switchTurns(currentTurn, true);
                  }, 600);
                }
              } else {
                let currentColorStep = parseInt(
                  element.parentElement.getAttribute(`data-${color}-step`)
                );
                console.log(
                  "current Color Step: " +
                    currentColorStep +
                    ", color: " +
                    color
                );
                if (
                  checkOpponentPin(
                    pickedColor,
                    document.querySelector(
                      `.box[data-${color}-step="${currentColorStep + number}"]`
                    ),
                    false
                  )
                ) {
                  pinAnimation(
                    currentTurn,
                    element,
                    element.parentElement,
                    number,
                    color
                  );
                  setTimeout(() => {
                    operating = true;
                    movePinHome(
                      pickedColor,
                      currentColorStep + number - 1,
                      currentTurn,
                      element
                    );
                    resizePinForGoal(element, pickedColor, number, currentTurn);
                  }, 600);
                } else {
                  // adjustPinSize(
                  //   pickedColor,
                  //   document.querySelector(
                  //     `.box[data-${color}-step="${currentColorStep}"]`
                  //   ),
                  //   document.querySelector(
                  //     `.box[data-${color}-step="${currentColorStep + number}"]`
                  //   ),
                  //   element,
                  //   timeOut
                  // );
                  pinAnimation(
                    currentTurn,
                    element,
                    element.parentElement,
                    number,
                    color
                  );
                  operating = true;
                  setTimeout(() => {
                    operating = true;
                    switchTurns(currentTurn, true);
                  }, timeOut);
                }
              }
            }
          } else {
            tracker = 0;
            console.log(tracker);
            let currentColorStep = parseInt(
              element.parentElement.getAttribute(`data-${color}-step`)
            );
            console.log(
              "current Color Step: " + currentColorStep + ", color: " + color
            );
            if (
              checkOpponentPin(
                pickedColor,
                document.querySelector(
                  `.box[data-${color}-step="${currentColorStep + number}"]`
                ),
                false
              )
            ) {
              pinAnimation(
                currentTurn,
                element,
                element.parentElement,
                number,
                color
              );
              setTimeout(() => {
                operating = true;
                movePinHome(
                  pickedColor,
                  currentColorStep + number - 1,
                  currentTurn,
                  element
                );
                resizePinForGoal(element, pickedColor, number, currentTurn);
              }, timeOut);
            } else {
              // adjustPinSize(
              //   pickedColor,
              //   document.querySelector(
              //     `.box[data-${color}-step="${currentColorStep}"]`
              //   ),
              //   document.querySelector(
              //     `.box[data-${color}-step="${currentColorStep + number}"]`
              //   ),
              //   element,
              //   timeOut
              // );
              pinAnimation(
                currentTurn,
                element,
                element.parentElement,
                number,
                color
              );
              operating = true;
              setTimeout(() => {
                operating = true;
                switchTurns(currentTurn, false);
              }, timeOut);
            }
          }
        } else if (CheakBoxesLeft(pickedColor, number, element) == false) {
          operating = true;
          switchTurns(currentTurn, false);
        } else if (CheakBoxesLeft(pickedColor, number, element) == "Goal") {
          pinAnimation(
            currentTurn,
            element,
            element.parentElement,
            number,
            color
          );
          setTimeout(() => {
            operating = true;
            resizePinForGoal(element, pickedColor, number, currentTurn);
          }, timeOut);
          // switchTurns(currentTurn, false);
        }
      }
      function resizePinForGoal(element, color, number, turn) {
        let box = element.parentElement;
        if (box.classList.contains("box")) {
          if (box.querySelectorAll(".pin").length > 1) {
            resetPinSizes(color, box, null, element);
          }
        }

        const playedColor = element.classList[1].split("-")[0];
        const winningPins = document.querySelectorAll(
          `.winning-pins .win-${playedColor}-pin`
        );
        const losingPins = document.querySelectorAll(
          `.winning-pins .win-${playedColor}-pin:not(.${playedColor}-bg)`
        );
        if (Array.isArray(color)) {
          // if (gameInfo["currentTurn"] == 0) {
          //   gameInfo["currentTurn"] = 1;
          // } else if (gameInfo["currentTurn"] == 1) {
          //   gameInfo["currentTurn"] = 0;
          // }
          if (
            (document.querySelectorAll(`.winning-pins .${color[0]}-bg`)
              .length == 3 &&
              document.querySelectorAll(`.winning-pins .${color[1]}-bg`)
                .length == 4) ||
            (document.querySelectorAll(`.winning-pins .${color[0]}-bg`)
              .length == 4 &&
              document.querySelectorAll(`.winning-pins .${color[1]}-bg`)
                .length == 3)
          ) {
            playAgainPlayers = JSON.parse(JSON.stringify(players));
            declearWinner(turn);
            return;
          }
          // if (number === 6) {
          //   switchTurns(players[gameInfo["currentTurn"]], true);
          // } else {
          //   switchTurns(players[gameInfo["currentTurn"]], false);
          // }
        } else {
          if (
            document.querySelectorAll(`.winning-pins .${color}-bg`).length == 3
          ) {
            if (turn.color == "blue") {
              if (players.findIndex((player) => player.color === "red") >= 0) {
                gameInfo["currentTurn"] = `${players.findIndex(
                  (player) => player.color === "red"
                )}`;
              } else {
                if (
                  players.findIndex((player) => player.color === "red") >
                  players.findIndex((player) => player.name === turn.name)
                ) {
                  gameInfo["currentTurn"] = gameInfo["currentTurn"] - 1;
                } else {
                  gameInfo["currentTurn"] = `${players.findIndex(
                    (player) => player.color === "green"
                  )}`;
                }
              }
            } else if (turn.color == "red") {
              if (players.findIndex((player) => player.color === "green") < 0) {
                if (
                  players.findIndex((player) => player.color === "green") >
                  players.findIndex((player) => player.name === turn.name)
                ) {
                  gameInfo["currentTurn"] = gameInfo["currentTurn"] - 1;
                } else {
                  gameInfo["currentTurn"] = `${players.findIndex(
                    (player) => player.color === "yellow"
                  )}`;
                }
              } else {
                gameInfo["currentTurn"] = `${players.findIndex(
                  (player) => player.color === "green"
                )}`;
              }
            } else if (turn.color == "green") {
              gameInfo["currentTurn"] = `${players.findIndex(
                (player) => player.color === "yellow"
              )}`;
              if (
                players.findIndex((player) => player.color === "yellow") >
                players.findIndex((player) => player.name === turn.name)
              ) {
                gameInfo["currentTurn"] = gameInfo["currentTurn"] - 1;
              }
            } else if (turn.color == "yellow") {
              gameInfo["currentTurn"] = `${players.findIndex(
                (player) => player.color === "blue"
              )}`;
              if (
                players.findIndex((player) => player.color === "blue") >
                players.findIndex((player) => player.name === turn.name)
              ) {
                gameInfo["currentTurn"] = gameInfo["currentTurn"] - 1;
              }
            }
            if ("positions" in gameInfo) {
              console.log(gameInfo["positions"]);

              if (gameInfo["positions"].length == 0) {
                gameInfo["positions"].push({ name: turn.name, position: 1 });
              } else if (gameInfo["positions"].length < 4) {
                let formerPlayerScore =
                  gameInfo["positions"][gameInfo["positions"].length - 1]
                    .position;
                if (gameInfo["positions"].length == 3) {
                  gameInfo["positions"].push({
                    name: turn.name,
                    position: formerPlayerScore + 1,
                  });
                } else {
                  if (players.length === 2) {
                    gameInfo["positions"].push({
                      name: turn.name,
                      position: formerPlayerScore + 1,
                    });
                    const lastPlayer = players.find(
                      (player) => player.name !== turn.name
                    );
                    gameInfo["positions"].push({
                      name: lastPlayer.name,
                      position: 4,
                    });
                    declearWinner(turn);
                    return;
                  } else {
                    gameInfo["positions"].push({
                      name: turn.name,
                      position: formerPlayerScore + 1,
                    });
                  }
                }
              } else if (gameInfo["positions"].length == 4) {
                console.log(gameInfo["positions"]);
              }
            } else {
              console.log(gameInfo["positions"]);
            }
            if (players.length === 4) {
              playAgainPlayers = JSON.parse(JSON.stringify(players));
            }
            players = players.filter((player) => player.name !== turn.name);
            if (playedColor == "yellow" || playedColor == "blue") {
              losingPins[losingPins.length - 1].classList.add(
                `${playedColor}-bg`
              );
            } else {
              for (let i = 0; i < winningPins.length; i++) {
                const element = winningPins[i];
                if (!element.classList.contains(`${playedColor}-bg`)) {
                  element.classList.add(`${playedColor}-bg`);
                  break;
                }
              }
            }
            element.remove();
            document.querySelector(`.player-${turn.number}-cover`).style
              .display == "block";
            document
              .querySelector(`.${turn.color}`)
              .classList.add("removed-player");
            document.querySelector(`.${turn.color} .flash`).style.display =
              "none";
            if (players.length == 1) {
              declearWinner(turn);
              return;
            }
            switchTurns(players[gameInfo["currentTurn"]], true);
            return;
            // declearWinner(turn);
          }
        }

        if (playedColor == "yellow" || playedColor == "blue") {
          losingPins[losingPins.length - 1].classList.add(`${playedColor}-bg`);
        } else {
          for (let i = 0; i < winningPins.length; i++) {
            const element = winningPins[i];
            if (!element.classList.contains(`${playedColor}-bg`)) {
              element.classList.add(`${playedColor}-bg`);
              break;
            }
          }
        }
        element.remove();
        if (number == 6) {
          operating = true;
          switchTurns(turn, true);
        } else {
          operating = true;
          switchTurns(turn, false);
        }
      }
      function declearWinner(winner) {
        displayMenu();
        const cube = document.getElementById("rool-dice");
        if (cube.style.display == "block" || cube.style.display) {
          cube.style.display = "none";
        }
        operating = true;
        pausedMove = true;
        if (
          gameInfo["positions"].length > 0 &&
          !players[0].hasOwnProperty("color2")
        ) {
          clickPlayAgain = (event) => {
            playAgain(playAgainPlayers);
          };
          console.log(gameInfo["positions"]);
          document.getElementById("pop-up").innerHTML = `
            <table class="score-table">
            <tr>
              <th class="max-text">Player</th>
              <th class="max-text">Score</th>
            </tr>
            <tr>
              <td class="min-text">${gameInfo["positions"][0].name}</td>
              <td>
                <i class="fas fa-star star"></i><i class="fas fa-star star"></i
                ><i class="fas fa-star star"></i>
              </td>
            </tr>
            <tr>
              <td class="min-text">${gameInfo["positions"][1].name}</td>
              <td>
                <i class="fas fa-star star"></i><i class="fas fa-star star"></i>
              </td>
            </tr>
            <tr>
              <td class="min-text">${gameInfo["positions"][2].name}</td>
              <td><i class="fas fa-star star"></i></td>
            </tr>
            <tr>
              <td class="min-text">${gameInfo["positions"][3].name}</td>
              <td></td>
            </tr>
          </table>
          <div class="score-menu">
            <button onclick="backToPlayOption()">
              Main menu
            </button>
            <button id="play-again">
              Play again
            </button>
          </div>`;
        } else {
          if (players.length == 2) {
            clickPlayAgain = (event) => {
              playAgain(players);
            };
            let winnnerScore = "1";
            let looserScore = "0";
            const opponentInfo = players.find(
              (opponent) => opponent.name !== winner.name
            );
            const indexOfWinner = players.findIndex(
              (Winner) => Winner.name === winner.name
            );
            const indexOfOpponent = players.findIndex(
              (Opponent) => Opponent.name === opponentInfo.name
            );
            if (winner.score) {
              winnnerScore = parseInt(winner.score);
              winnnerScore += 1;
            }
            if (opponentInfo.score) {
              looserScore = opponentInfo.score;
            }
            players[indexOfWinner].score = winnnerScore;
            players[indexOfOpponent].score = looserScore;
            document.getElementById("pop-up").innerHTML = `
            <div class="winner-menu">
              <div class="score-info">
                <div class="player-info">
                  <p>${winner.name}</p>
                </div>
                <div class="score">${winnnerScore} - ${looserScore}</div>
                <div class="player-info">
                  <p>${opponentInfo.name}</p>
                </div>
              </div>
              <div class="score-menu">
                <button onclick="backToPlayOption()">
                  Main menu
                </button>
                <button id="play-again">
                  Play again
                </button>
              </div>
            </div>`;
          }
        }
        if (document.getElementById("play-again")) {
          document
            .getElementById("play-again")
            .addEventListener("click", clickPlayAgain, { once: true });
        }
      }
      function playAgain(Players) {
        document
          .getElementById("play-again")
          .removeEventListener("click", clickPlayAgain);
        console.log(Players);
        if (Players) {
          if (gameInfo["positions"].length > 0) {
            gameInfo["positions"] = [];
            players.length = 0;
            if (Array.isArray(Players)) {
              Players.forEach((player) => {
                players.push(player);
              });
            }
          }
          resetBoard();
          removeMenu();
          if (listenerAdded) {
            document
              .getElementById("rool-dice")
              .removeEventListener("click", clickRoolDice);
          }
          randomStartGame("with-Ai", numberOfPlayers);
        }
      }
      function resetBoard() {
        document.querySelectorAll(".board .pin").forEach((pin) => {
          pin.remove();
        });
        document.querySelectorAll(".win-pin").forEach((winPin) => {
          if (winPin.classList.length > 3) {
            Array.from(winPin.classList).forEach((cls, i) => {
              if (i > 2) {
                winPin.classList.remove(cls);
              }
            });
          }
        });
        document.querySelectorAll(".home").forEach((home) => {
          let firstPin = document.createElement("div");
          firstPin.classList.add(
            "pin",
            `${home.classList[0]}-bg-lighter`,
            `${home.classList[0]}-pin-1`,
            "pin-in-parent-1"
          );
          let secondPin = document.createElement("div");
          secondPin.classList.add(
            "pin",
            `${home.classList[0]}-bg-lighter`,
            `${home.classList[0]}-pin-2`,
            "pin-in-parent-2"
          );
          let thirdPin = document.createElement("div");
          thirdPin.classList.add(
            "pin",
            `${home.classList[0]}-bg-lighter`,
            `${home.classList[0]}-pin-3`,
            "pin-in-parent-3"
          );
          let forthPin = document.createElement("div");
          forthPin.classList.add(
            "pin",
            `${home.classList[0]}-bg-lighter`,
            `${home.classList[0]}-pin-4`,
            "pin-in-parent-4"
          );
          if (home.classList.contains("removed-player")) {
            home.classList.remove("removed-player");
          }
          home.querySelector(".pins").appendChild(firstPin);
          home.querySelector(".pins").appendChild(secondPin);
          home.querySelector(".pins").appendChild(thirdPin);
          home.querySelector(".pins").appendChild(forthPin);
        });
        document.querySelectorAll(".pin").forEach((element) => {
          element.style.height = `${
            document.querySelector(".box").clientHeight
          }px`;
          element.style.width = `${
            document.querySelector(".box").clientWidth
          }px`;
        });
        document
          .querySelectorAll(".player-cover")
          .forEach((playerInfoCover) => {
            playerInfoCover.style.display = "none";
          });
        document.querySelector(".board-cover").style.display = "none";
        document.querySelectorAll(`.flash`).forEach((flash) => {
          flash.style.display = "none";
          if (flash.classList.contains("flash2")) {
            flash.classList.remove("flash2");
          }
        });
        document.querySelector(".board-cover").style.display = "none";
      }
      function resetPinSizes(color, currentBox, entryBox, playedPin) {
        if (entryBox) {
          if (!entryBox.querySelector(".pin")) {
            if (playedPin.classList.length > 4) {
              Array.from(playedPin.classList).forEach((cls, i) => {
                if (i > 4) {
                  playedPin.classList.remove(cls);
                }
              });
            }
          }
        }
        console.log(currentBox);
        if (currentBox) {
          let indexToRemove = Array.from(
            currentBox.querySelectorAll(".pin")
          ).indexOf(playedPin);
          let pins = Array.from(currentBox.querySelectorAll(".pin")).filter(
            (_, index) => index !== indexToRemove
          );
          let pinNumber = 1;
          if (pins.length > 1) {
            for (let i = 0; i < pins.length; i++) {
              let pin = pins[i];
              if (pin.classList.length > 3) {
                Array.from(pin.classList).forEach((cls, index) => {
                  if (index > 3) {
                    pin.classList.remove(`${cls}`);
                  }
                });
              }
              pin.style.width = `${currentBox.clientWidth / 2}px`;
              pin.style.height = `${currentBox.clientHeight / 2}px`;
              pin.classList.add(`pin-in-box-${pinNumber}`);
              console.log(`pin-in-box-${pinNumber}`);
              pinNumber += 1;
            }
          } else {
            console.log(playedPin);

            if (pins[0].classList.length > 4) {
              Array.from(pins[0].classList).forEach((cls, index) => {
                if (index > 3) {
                  pins[0].classList.remove(`${cls}`);
                }
              });
            }
            pins[0].style.width = `${currentBox.clientWidth}px`;
            pins[0].style.height = `${currentBox.clientHeight}px`;
            if (playedPin.classList.length > 4) {
              Array.from(playedPin.classList).forEach((cls, index) => {
                if (index > 3) {
                  playedPin.classList.remove(`${cls}`);
                }
              });
            }
            playedPin.style.width = `${currentBox.clientWidth}px`;
            playedPin.style.height = `${currentBox.clientHeight}px`;
          }
        }
      }
      function pathBlocked(color, currentBox, playedPin, number) {
        let betweenBoxes = [];
        let isBlocked = false;
        if (currentBox) {
          let currentColorStep = parseInt(
            currentBox.getAttribute(`data-${color}-step`)
          );
          for (let i = 1; i <= number; i++) {
            let box = document.querySelector(
              `.box[data-${color}-step="${currentColorStep + i}"]`
            );
            if (
              box &&
              box.querySelector(".pin") &&
              box.querySelectorAll(".pin").length > 1
            ) {
              let message = "Path blocked because of stacked pins";
              let timeOut = message.length * 500;
              alertPlayer("block", message);
              setTimeout(() => {
                return true;
              }, timeOut);
            } else {
              isBlocked = false;
            }
          }
        } else {
          isBlocked = false;
        }
        return isBlocked;
      }
      function adjustPinSize(
        colorArray,
        currentBox,
        entryBox,
        playedPin,
        timeOut
      ) {
        let color;
        let color2;
        if (Array.isArray(colorArray)) {
          color = colorArray[0];
          color2 = colorArray[1];
        } else {
          color = colorArray;
          color2 = "";
        }
        if (entryBox) {
          if (currentBox) {
            if (currentBox.querySelector(".pin")) {
              if (currentBox.querySelectorAll(".pin").length == 2) {
                let index = Array.from(
                  currentBox.querySelectorAll(".pin")
                ).indexOf(playedPin);
                let pin;
                if (index == 0) {
                  pin = currentBox.querySelectorAll(".pin")[1];
                } else if (index == 1) {
                  pin = currentBox.querySelectorAll(".pin")[0];
                } else {
                }
                pin.style.width = `${currentBox.clientWidth}px`;
                pin.style.height = `${currentBox.clientHeight}px`;
                playedPin.style.width = `${currentBox.clientWidth}px`;
                playedPin.style.height = `${currentBox.clientHeight}px`;
                console.log("1 pin in current box");
              } else if (currentBox.querySelectorAll(".pin").length > 2) {
                resetPinSizes(color, currentBox, entryBox, playedPin);
                console.log("1 pin in current box 2");
              } else {
                Array.from(playedPin.classList).forEach((cls, i) => {
                  if (i > 3) {
                    playedPin.classList.remove(cls);
                  }
                });
                console.log(currentBox.querySelectorAll(".pin").length);
              }
            }
          }
          if (entryBox.querySelector(".pin")) {
            let pins = entryBox.querySelectorAll(".pin");
            if (pins.length - 1 == 0) {
              if (playedPin.classList.length > 4) {
                Array.from(playedPin.classList).forEach((cls, i) => {
                  if (i > 3) {
                    playedPin.classList.remove(cls);
                  }
                });
              }
              if (pins[0].classList.length > 4) {
                Array.from(pins[0].classList).forEach((cls, i) => {
                  if (i > 3) {
                    pins[0].classList.remove(cls);
                  }
                });
              }
              if (
                entryBox
                  .querySelector(".pin")
                  .classList.contains(`${color}-bg-lighter`) ||
                entryBox
                  .querySelector(".pin")
                  .classList.contains(`${color2}-bg-lighter`)
              ) {
                console.log("pin number:");
                setTimeout(() => {
                  pins[0].classList.add(`pin-in-box-1`);
                  pins[0].style.width = `${entryBox.clientWidth / 2}px`;
                  pins[0].style.height = `${entryBox.clientHeight / 2}px`;
                  playedPin.classList.add(`pin-in-box-2`);
                  playedPin.style.width = `${entryBox.clientWidth / 2}px`;
                  playedPin.style.height = `${entryBox.clientHeight / 2}px`;
                  console.log(timeOut);
                }, timeOut);
              }
            } else if (pins.length - 1 > 0) {
              if (pins[pins.length - 1].classList.contains("pin-in-box-2")) {
                setTimeout(() => {
                  for (let i = 0; i < pins.length; i++) {
                    let pin = pins[i];
                    pin.style.width = `${entryBox.clientWidth / 2 - 1.5}px`;
                    pin.style.height = `${entryBox.clientHeight / 2 - 1.5}px`;
                  }
                  playedPin.classList.add(`pin-in-box-3`);
                  playedPin.style.width = `${entryBox.clientWidth / 2 - 1.5}px`;
                  playedPin.style.height = `${
                    entryBox.clientHeight / 2 - 1.5
                  }px`;
                }, timeOut);
              } else if (
                pins[pins.length - 1].classList.contains("pin-in-box-3")
              ) {
                setTimeout(() => {
                  for (let i = 0; i < pins.length; i++) {
                    let pin = pins[i];
                    pin.style.width = `${entryBox.clientWidth / 2 - 1.5}px`;
                    pin.style.height = `${entryBox.clientHeight / 2 - 1.5}px`;
                  }
                  playedPin.classList.add(`pin-in-box-4`);
                  playedPin.style.width = `${entryBox.clientWidth / 2 - 1.5}px`;
                  playedPin.style.height = `${
                    entryBox.clientHeight / 2 - 1.5
                  }px`;
                }, timeOut);
              }
            } else {
              console.log("0 pin in current box");
              playedPin.style.width = `${entryBox.clientWidth}px`;
              playedPin.style.height = `${entryBox.clientHeight}px`;
              if (playedPin.classList.length > 3) {
                Array.from(playedPin.classList).forEach((cls, i) => {
                  if (i > 3) {
                    playedPin.classList.remove(cls);
                  }
                });
              }
            }
          } else {
            console.log("0 pin in current box");
            playedPin.style.width = `${entryBox.clientWidth}px`;
            playedPin.style.height = `${entryBox.clientHeight}px`;
            if (playedPin.classList.length > 3) {
              Array.from(playedPin.classList).forEach((cls, i) => {
                if (i > 3) {
                  playedPin.classList.remove(cls);
                }
              });
            }
          }
        }
      }
      function movePinHome(color, number, currentTurn, playedPin) {
        let pinColor;
        let pinColor2;
        if (Array.isArray(color)) {
          pinColor = color[0];
          pinColor2 = color[1];
        } else {
          pinColor = color;
          pinColor2 = "";
        }
        let entryBox = document.querySelector(
          `.box[data-${playedPin.classList[1].split("-")[0]}-step="${
            number + 1
          }"]`
        );
        if (entryBox) {
          if (entryBox.querySelector(".pin")) {
            if (entryBox.querySelectorAll(".pin").length <= 2) {
              let entryBoxPin = entryBox.querySelector(".pin");
              if (
                entryBoxPin.classList[1] != `${pinColor}-bg-lighter` &&
                entryBoxPin.classList[1] != `${pinColor2}-bg-lighter`
              ) {
                let opponentColor = entryBoxPin.classList[1].split("-")[0];
                pinAnimation(
                  currentTurn,
                  entryBoxPin,
                  entryBoxPin.parentElement,
                  number,
                  opponentColor,
                  "move-home"
                );
                Array.from(entryBoxPin.classList).forEach((cls, i) => {
                  if (i > 3) {
                    entryBoxPin.classList.remove(cls);
                  }
                });
                entryBoxPin.style.width = `${entryBox.clientWidth}px`;
                entryBoxPin.style.height = `${entryBox.clientHeight}px`;

                if (
                  entryBoxPin.classList.contains(
                    `pin-in-box-${entryBoxPin.classList[2].split("-")[2]}`
                  )
                ) {
                  entryBoxPin.classList.remove(
                    `pin-in-box-${entryBoxPin.classList[2].split("-")[2]}`
                  );
                }
              }
            } else {
              let pins = entryBox.querySelectorAll(".pin");
              // resetPinSizes(opponentColor, entryBox, null, movingPin);
              for (let i = 0; i < pins.length; i++) {
                let pin = pins[i];
                if (
                  pin.classList[1] != `${pinColor}-bg-lighter` &&
                  pin.classList[1] != `${pinColor2}-bg-lighter`
                ) {
                  let movingPin = pin;
                  Array.from(movingPin.classList).forEach((cls, i) => {
                    if (i > 3) {
                      movingPin.classList.remove(cls);
                    }
                  });
                  if (
                    movingPin.classList.contains(
                      `pin-in-box-${movingPin.classList[2].split("-")[2]}`
                    )
                  ) {
                    movingPin.classList.remove(
                      `pin-in-box-${movingPin.classList[2].split("-")[2]}`
                    );
                  }
                  let opponentColor = movingPin.classList[1].split("-")[0];
                  movingPin.style.height = `${entryBox.clientHeight}px`;
                  movingPin.style.width = `${entryBox.clientWidth}px`;
                  pinAnimation(
                    currentTurn,
                    movingPin,
                    movingPin.parentElement,
                    number,
                    opponentColor,
                    "move-home"
                  );
                  // resetPinSizes(opponentColor, null, entryBox, movingPin);
                  return;
                }
              }
            }
          }
        }
      }
      function checkOpponentPin(color, entryBox, currentBox) {
        if (entryBox) {
          if (entryBox.querySelector(".pin")) {
            if (entryBox.querySelectorAll(".pin").length > 1) {
              let pins = entryBox.querySelectorAll(".pin");
              for (let i = 0; i < pins.length; i++) {
                let pin = pins[i];
                if (Array.isArray(color)) {
                  if (
                    pin.classList[1] != `${color[0]}-bg-lighter` &&
                    pin.classList[1] != `${color[1]}-bg-lighter`
                  ) {
                    return true;
                  } else {
                    if (i == pins.length - 1) {
                      return false;
                    }
                  }
                } else {
                  if (pin.classList[1] != `${color}-bg-lighter`) {
                    return true;
                  } else {
                    if (i == pins.length - 1) {
                      return false;
                    }
                  }
                }
              }
            } else {
              let entryBoxPin = entryBox.querySelector(".pin");
              if (Array.isArray(color)) {
                if (
                  entryBoxPin.classList[1] != `${color[0]}-bg-lighter` &&
                  entryBoxPin.classList[1] != `${color[1]}-bg-lighter`
                ) {
                  return true;
                } else {
                  return false;
                }
              } else {
                if (entryBoxPin.classList[1] != `${color}-bg-lighter`) {
                  return true;
                } else {
                  return false;
                }
              }
            }
          } else {
            return false;
          }
        } else {
          return false;
        }
      }
      function aiAlgorithm(number, color, turn) {
        let pinBoxes = [];
        let randomPick = false;
        const timeOut = (200 + 200) * number;
        const pins = [];
        const boxes = document.querySelectorAll(`.box`);
        for (let i = 0; i < boxes.length; i++) {
          let box = boxes[i];
          if (
            box.querySelectorAll(".pin").length < 2 &&
            box.querySelectorAll(".pin").length > 0
          ) {
            let pin = box.querySelector(".pin");
            if (Array.isArray(color)) {
              if (
                pin.classList.contains(`${color[0]}-bg-lighter`) ||
                pin.classList.contains(`${color[1]}-bg-lighter`)
              ) {
                let currentColorStep;
                let pinColor;
                if (
                  pin.classList.contains(`${color[0]}-bg-lighter`) &&
                  !pin.classList.contains(`${color[1]}-bg-lighter`)
                ) {
                  pinColor = color[0];
                  currentColorStep = parseInt(
                    box.getAttribute(`data-${color[0]}-step`)
                  );
                } else if (
                  !pin.classList.contains(`${color[0]}-bg-lighter`) &&
                  pin.classList.contains(`${color[1]}-bg-lighter`)
                ) {
                  pinColor = color[1];

                  currentColorStep = parseInt(
                    box.getAttribute(`data-${color[1]}-step`)
                  );
                } else {
                  currentColorStep = 0;
                }
                const boxPin = box.querySelector(".pin");
                const entryBox = document.querySelector(
                  `.box[data-${pinColor}-step="${currentColorStep + number}"]`
                );
                if (CheakBoxesLeft(color, number, boxPin) == true) {
                  if (checkOpponentPin(color, entryBox, false)) {
                    pinAnimation(
                      turn,
                      boxPin,
                      box,
                      number,
                      boxPin.classList[1].split("-")[0]
                    );
                    setTimeout(() => {
                      operating = true;
                      movePinHome(
                        color,
                        currentColorStep + number - 1,
                        turn,
                        boxPin
                      );
                      resizePinForGoal(boxPin, color, number, turn);
                    }, timeOut);
                    randomPick = false;
                    return;
                  } else {
                    pinBoxes.push(box);
                    randomPick = true;
                  }
                } else if (CheakBoxesLeft(color, number, boxPin) == "Goal") {
                  pinAnimation(
                    turn,
                    boxPin,
                    box,
                    number,
                    boxPin.classList[1].split("-")[0]
                  );
                  setTimeout(() => {
                    operating = true;
                    resizePinForGoal(boxPin, color, number, turn);
                  }, timeOut);
                  randomPick = false;
                  return;
                } else {
                  operating = true;
                  // if (number === 6) {
                  //   switchTurns(turn, true);
                  // } else {
                  //   switchTurns(turn, false);
                  // }
                }
              }
            } else {
              if (pin.classList.contains(`${color}-bg-lighter`)) {
                const boxPin = box.querySelector(".pin");
                const currentColorStep = parseInt(
                  box.getAttribute(`data-${color}-step`)
                );
                const entryBox = document.querySelector(
                  `.box[data-${color}-step="${currentColorStep + number}"]`
                );
                if (CheakBoxesLeft(color, number, boxPin) == true) {
                  if (checkOpponentPin(color, entryBox, false)) {
                    pinAnimation(
                      turn,
                      boxPin,
                      box,
                      number,
                      boxPin.classList[1].split("-")[0]
                    );
                    setTimeout(() => {
                      operating = true;
                      movePinHome(
                        color,
                        currentColorStep + number - 1,
                        turn,
                        boxPin
                      );
                      resizePinForGoal(boxPin, color, number, turn);
                    }, timeOut);
                    randomPick = false;
                    return;
                  } else {
                    pinBoxes.push(box);
                    randomPick = true;
                  }
                } else if (CheakBoxesLeft(color, number, boxPin) == "Goal") {
                  pinAnimation(
                    turn,
                    boxPin,
                    box,
                    number,
                    boxPin.classList[1].split("-")[0]
                  );
                  setTimeout(() => {
                    operating = true;
                    resizePinForGoal(boxPin, color, number, turn);
                  }, timeOut);
                  randomPick = false;
                  return;
                } else {
                  operating = true;
                  // if (number === 6) {
                  //   switchTurns(turn, true);
                  // } else {
                  //   switchTurns(turn, false);
                  // }
                }
              }
            }
          } else if (box.querySelectorAll(".pin").length >= 2) {
            randomPick = true;
            const pins = box.querySelectorAll(".pin");
            for (let i = 0; i < pins.length; i++) {
              let pin = pins[i];
              if (Array.isArray(color)) {
                if (
                  pin.classList.contains(`${color[0]}-bg-lighter`) ||
                  pin.classList.contains(`${color[1]}-bg-lighter`)
                ) {
                  pinBoxes.push(box);
                }
              } else {
                if (pin.classList.contains(`${color}-bg-lighter`)) {
                  pinBoxes.push(box);
                }
              }
            }
            console.log(pinBoxes);
          }
        }
        if (randomPick && pinBoxes.length > 0) {
          randomPinPick(color, number, pinBoxes, turn);
        } else {
          operating = true;
          if (number === 6) {
            switchTurns(turn, true);
          } else {
            switchTurns(turn, false);
          }
        }
      }
      function randomPinPick(color, number, pinBoxes, turn) {
        console.log(pinBoxes);
        const timeOut = (200 + 200) * number;
        const randomBox = pinBoxes[Math.floor(Math.random() * pinBoxes.length)];
        let randomBoxColorStep;
        let randomPinColor;
        if (Array.isArray(color)) {
          if (
            randomBox
              .querySelector(".pin")
              .classList.contains(`${color[0]}-bg-lighter`) &&
            !randomBox
              .querySelector(".pin")
              .classList.contains(`${color[1]}-bg-lighter`)
          ) {
            randomBoxColorStep = parseInt(
              randomBox.getAttribute(`data-${color[0]}-step`)
            );
            randomPinColor = color[0];
          } else if (
            !randomBox
              .querySelector(".pin")
              .classList.contains(`${color[0]}-bg-lighter`) &&
            randomBox
              .querySelector(".pin")
              .classList.contains(`${color[1]}-bg-lighter`)
          ) {
            randomBoxColorStep = parseInt(
              randomBox.getAttribute(`data-${color[1]}-step`)
            );
            randomPinColor = color[1];
          }
        } else {
          randomBoxColorStep = parseInt(
            randomBox.getAttribute(`data-${color}-step`)
          );
          randomPinColor = color;
        }
        if (randomBoxColorStep + number <= 56) {
          if (
            checkOpponentPin(
              color,
              document.querySelector(
                `.box[data-${randomPinColor}-step="${
                  randomBoxColorStep + number
                }"]`
              ),
              false
            )
          ) {
            pinAnimation(
              turn,
              randomBox.querySelector(`.${randomPinColor}-bg-lighter`),
              randomBox,
              number,
              randomPinColor
            );
            setTimeout(() => {
              operating = true;
              movePinHome(
                color,
                randomBoxColorStep + number - 1,
                turn,
                randomBox.querySelector(`.${randomPinColor}-bg-lighter`)
              );
              resizePinForGoal(
                randomBox.querySelector(`.${randomPinColor}-bg-lighter`),
                color,
                number,
                turn
              );
            }, timeOut);
          } else {
            // adjustPinSize(
            //   color,
            //   randomBox,
            //   document.querySelector(
            //     `.box[data-${randomPinColor}-step="${
            //       randomBoxColorStep + number
            //     }"]`
            //   ),
            //   randomBox.querySelector(`.${randomPinColor}-bg-lighter`),
            //   timeOut
            // );
            pinAnimation(
              turn,
              randomBox.querySelector(`.${randomPinColor}-bg-lighter`),
              randomBox,
              number,
              randomPinColor
            );
            operating = true;
            setTimeout(() => {
              operating = true;
              if (number === 6) {
                switchTurns(turn, true);
              } else {
                switchTurns(turn, false);
              }
            }, timeOut);
          }
        } else {
          operating = true;
          if (number === 6) {
            switchTurns(turn, true);
          } else {
            switchTurns(turn, false);
          }
        }
      }
      function toggleDisplayDice() {
        const cube = document.getElementById("rool-dice");
        alert(cube.style.display);
        if (cube.style.display == "none" || !cube.style.display) {
          cube.style.display = "block";
        } else {
          cube.style.display = "none";
        }
      }
      function diceAnimation(cube, number) {
        if (number == 1) {
          cube.classList.add("scale-dice");
          cube.querySelector(".dice").classList.add("scale-dice-face");
          cube.style.transform = `rotateX(${
            resetTransformation + 0
          }deg) rotateY(${resetTransformation + 0}deg)`;
          setTimeout(() => {
            cube.classList.remove("scale-dice");
            cube.querySelector(".dice").classList.remove("scale-dice-face");
          }, 1700);
        } else if (number == 2) {
          cube.classList.add("scale-dice");
          cube.style.transform = `rotateX(${
            resetTransformation + 0
          }deg) rotateY(${resetTransformation - 90}deg)`;
          setTimeout(() => {
            cube.classList.remove("scale-dice");
            cube.querySelector(".dice").classList.remove("scale-dice-face");
          }, 1700);
        } else if (number == 3) {
          cube.classList.add("scale-dice");
          cube.style.transform = `rotateX(${
            resetTransformation - 90
          }deg) rotateY(${resetTransformation + 0}deg)`;
          setTimeout(() => {
            cube.classList.remove("scale-dice");
            cube.querySelector(".dice").classList.remove("scale-dice-face");
          }, 1700);
        } else if (number == 4) {
          cube.classList.add("scale-dice");
          cube.style.transform = `rotateX(${
            resetTransformation + 90
          }deg) rotateY(${resetTransformation + 0}deg)`;
          setTimeout(() => {
            cube.classList.remove("scale-dice");
            cube.querySelector(".dice").classList.remove("scale-dice-face");
          }, 1700);
        } else if (number == 5) {
          cube.classList.add("scale-dice");
          cube.style.transform = `rotateX(${
            resetTransformation + 0
          }deg) rotateY(${resetTransformation + 90}deg)`;
          setTimeout(() => {
            cube.classList.remove("scale-dice");
            cube.querySelector(".dice").classList.remove("scale-dice-face");
          }, 1700);
        } else if (number == 6) {
          cube.classList.add("scale-dice");
          cube.style.transform = `rotateX(${
            resetTransformation + 0
          }deg) rotateY(${resetTransformation + 180}deg)`;
          setTimeout(() => {
            cube.classList.remove("scale-dice");
            cube.querySelector(".dice").classList.remove("scale-dice-face");
          }, 1700);
        }
      }
      function delay(ms) {
        return new Promise((resolve) => setTimeout(resolve, ms));
      }
      async function pinAnimation(turn, pin, box, number, color, operation) {
        if (operation === "move-home") {
          pin.classList.add("shrink");
          await delay(200);
          document.querySelector(`.${color} .pins`).append(pin);
          pin.classList.remove("shrink");
          pin.classList.add("grow");
          await delay(200);

          // reset class so next loop works
          pin.classList.remove("grow");

          // Optional pause before next move
          // await delay(400);
        } else if (operation === "move-out") {
          pin.classList.add("shrink");
          await delay(200);
          document.querySelector(`.box[data-${color}-step="1"]`).append(pin);
          pin.classList.remove("shrink");
          pin.classList.add("grow");
          await delay(200);

          // reset class so next loop works
          pin.classList.remove("grow");

          // Optional pause before next move
          // await delay(400);
        } else {
          let playerColor = color;
          if (turn.hasOwnProperty("color2")) {
            playerColor = [turn.color1, turn.color2];
          }
          const currentColorStep = parseInt(
            box.getAttribute(`data-${color}-step`)
          );
          if (currentColorStep + number > 56) {
            for (let i = 1; i < number; i++) {
              // pin.classList.add("shrink");
              await delay(200);
              adjustPinSize(
                playerColor,
                pin.parentElement,
                document.querySelector(
                  `.box[data-${color}-step="${currentColorStep + i}"]`
                ),
                pin
              );
              document
                .querySelector(
                  `.box[data-${color}-step="${currentColorStep + i}"]`
                )
                .append(pin);
              // pin.classList.remove("shrink");
              // pin.classList.add("grow");
              await delay(200);

              // reset class so next loop works
              // pin.classList.remove("grow");

              // Optional pause before next move
              // await delay(100);
            }
          } else {
            for (let i = 1; i <= number; i++) {
              // pin.classList.add("shrink");
              await delay(200);
              adjustPinSize(
                playerColor,
                pin.parentElement,
                document.querySelector(
                  `.box[data-${color}-step="${currentColorStep + i}"]`
                ),
                pin
              );
              document
                .querySelector(
                  `.box[data-${color}-step="${currentColorStep + i}"]`
                )
                .append(pin);
              // pin.classList.remove("shrink");
              // pin.classList.add("grow");
              await delay(200);

              // reset class so next loop works
              // pin.classList.remove("grow");

              // Optional pause before next move
              // await delay(100);
            }
          }
        }
      }
      function roolDice(turn) {
        let color;
        console.log(turn);

        if (turn.hasOwnProperty("color1")) {
          color = [turn.color1, turn.color2];
        } else {
          color = turn.color;
        }
        console.log(turn);
        if (
          (operating == false &&
            turn.name == playerName &&
            pausedMove == false) ||
          (operating == true && turn.name != playerName && pausedMove == false)
        ) {
          console.log("good");

          const cube = document.getElementById("rool-dice");
          if (cube.style.display == "none" || !cube.style.display) {
            cube.style.display = "block";
          }
          operating = true;
          if (resetTransformation == 0) {
            resetTransformation = 360 * 4;
          } else {
            resetTransformation = 0;
          }
          console.log(resetTransformation);

          let number = Math.floor(Math.random() * 6) + 1;
          setTimeout(() => {
            diceAnimation(cube, number);
          }, 100);
          setTimeout(() => {
            if (
              document.getElementById("rool-dice").getAttribute("data-turn") ==
              turn.name
            ) {
              gameAlgorithm(number, color, turn);
              document
                .getElementById("rool-dice")
                .setAttribute("data-turn", turn.name);
            } else {
              if (
                turn.name != playerName ||
                document
                  .getElementById("rool-dice")
                  .getAttribute("data-turn") != playerName
              ) {
                gameAlgorithm(number, color, turn);
              }
            }
          }, 1700);
        } else {
          console.log("bad");
          console.log(pausedMove);
          console.log(operating);
          return;
        }
      }
      function alertPlayer(display, message) {
        const alert = document.getElementById("alert");
        if (message) {
          alert.querySelector("p").innerText = message;
          alert.style.paddingBottom = "2.7rem";
          const timeOut = message.length * 100;
          setTimeout(() => {
            alert.style.paddingBottom = "0";
            alert.querySelector("p").innerText = "";
          }, timeOut);
        } else {
          alert.style.paddingBottom = "0";
          alert.querySelector("p").innerText = "";
        }
      }
    </script>
  </body>
</html>
